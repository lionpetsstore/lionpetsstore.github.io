<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>èŠæ©å¯µç‰©æ²™é¾ç²¾å“æ—…é¤¨ | Lion Pet Beauty Casa</title>
    
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        lion: {
                            navy: '#1B365D',      /* æ·±æµ·è»è— */
                            gold: '#C5A065',      /* é¦™æª³é‡‘ */
                            light: '#F5F5F7',     /* æ·ºç°ç™½ */
                            line: '#06C755',      /* LINE ç¶ è‰² */
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans TC"', 'sans-serif'],
                        serif: ['"Playfair Display"', 'serif']
                    },
                    animation: {
                        'scroll': 'scroll 25s linear infinite',
                        'fade-in': 'fadeIn 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards',
                        'slide-up': 'slideUp 0.4s cubic-bezier(0.22, 1, 0.36, 1) forwards',
                        'slide-down': 'slideDown 0.3s ease-out forwards',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 10s infinite ease-in-out',
                        'float-delayed': 'float 12s infinite ease-in-out reverse',
                    },
                    keyframes: {
                        scroll: {
                            '0%': { transform: 'translateX(0)' },
                            '100%': { transform: 'translateX(-50%)' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(100%)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        slideDown: {
                            '0%': { opacity: '0', transform: 'translateY(-10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translate(0, 0)' },
                            '50%': { transform: 'translate(0, 20px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap');

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #F5F5F7;
            color: #1B365D;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* ç»ç’ƒæ“¬æ…‹ */
        .glass-premium {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.9);
            box-shadow: 0 10px 40px -10px rgba(27, 54, 93, 0.1);
            border-radius: 1.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .glass-premium::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 100%;
            background: linear-gradient(180deg, rgba(255,255,255,0.6) 0%, rgba(255,255,255,0) 100%);
            pointer-events: none; z-index: 0;
        }

        .bg-orb { position: fixed; border-radius: 50%; filter: blur(80px); z-index: -1; opacity: 0.6; }

        .cute-input { 
            background: rgba(255, 255, 255, 0.6); 
            border: 1px solid #E2E8F0; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: #1B365D; font-size: 0.95rem; backdrop-filter: blur(4px);
        }
        .cute-input:focus { 
            background: #ffffff; border-color: #1B365D; outline: none; 
            box-shadow: 0 0 0 4px rgba(27, 54, 93, 0.1);
            transform: translateY(-1px);
        }

        .radio-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1px solid #E2E8F0; 
            background: rgba(255, 255, 255, 0.5);
            position: relative; overflow: hidden;
        }
        .radio-card:hover { border-color: #C5A065; background: rgba(255, 255, 255, 0.8); }
        .radio-card:active { transform: scale(0.98); }
        
        .radio-card.selected {
            background-color: #fff; 
            border-color: #1B365D; border-width: 2px;
            box-shadow: 0 8px 20px -4px rgba(27, 54, 93, 0.15);
        }
        .radio-card.danger.selected { background-color: #FEF2F2; border-color: #EF4444; }

        .fullscreen-signature { position: fixed; inset: 0; z-index: 100; background: white; display: flex; flex-direction: column; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div class="bg-orb w-96 h-96 bg-blue-100 top-[-10%] left-[-10%] animate-float"></div>
    <div class="bg-orb w-80 h-80 bg-orange-100 bottom-[-10%] right-[-10%] animate-float-delayed"></div>
    <div class="bg-orb w-64 h-64 bg-purple-50 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-pulse-slow"></div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        const mockSubmit = async (data) => {
            return new Promise((resolve) => setTimeout(() => resolve({ status: 'success' }), 1500));
        };

        // --- ä¿®æ­£å¾Œçš„ Icon å…ƒä»¶ (é˜²æ­¢ lucide æœªè¼‰å…¥å°è‡´å ±éŒ¯) ---
        const Icon = ({ name, size = 20, className = "" }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (iconRef.current && window.lucide) {
                    iconRef.current.innerHTML = '';
                    const i = document.createElement('i');
                    i.setAttribute('data-lucide', name);
                    i.style.width = '100%';
                    i.style.height = '100%';
                    iconRef.current.appendChild(i);
                    window.lucide.createIcons({ root: iconRef.current });
                }
            }, [name]);
            return <span ref={iconRef} style={{ width: size, height: size, display: 'inline-flex' }} className={className} />;
        };

        // --- è·‘é¦¬ç‡ˆå…ƒä»¶ ---
        const Marquee = () => {
            const images = [
                'line_oa_chat_260121_230912_group_0.jpg', 'line_oa_chat_260121_230912_group_1.jpg',
                'line_oa_chat_260121_230912_group_2.jpg', 'line_oa_chat_260121_230908_group_0.jpg',
                'line_oa_chat_260121_230908_group_1.jpg', 'line_oa_chat_260121_230908_group_2.jpg'
            ];
            return (
                <div className="w-full overflow-hidden relative h-48 md:h-64 rounded-[2rem] mb-10 glass-premium border-0 shadow-2xl group transform hover:scale-[1.01] transition-transform duration-500">
                    <div className="absolute inset-0 z-10 bg-lion-navy/5 pointer-events-none group-hover:bg-transparent transition-colors"></div>
                    <div className="flex w-[200%] animate-scroll h-full">
                        {[...images, ...images].map((src, idx) => (
                            <div key={idx} className="w-1/3 h-full flex-shrink-0 px-2 py-2">
                                <img src={src} className="w-full h-full object-cover rounded-2xl shadow-sm" alt="Environment" onError={(e)=>{e.target.style.display='none'}} />
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const Toast = ({ message, type = 'error' }) => (
            <div className={`fixed top-6 left-1/2 -translate-x-1/2 z-[200] px-6 py-3 rounded-full shadow-2xl text-white font-bold text-sm tracking-wide flex items-center gap-3 ${type === 'error' ? 'bg-red-500/90' : 'bg-lion-line/90'} backdrop-blur-md animate-fade-in border border-white/20`}>
                <Icon name={type==='error'?'alert-circle':'check-circle'} size={18}/>
                {message}
            </div>
        );

        const InputWithError = ({ label, name, type = 'text', value, onChange, placeholder, error, className = '', ...props }) => (
            <div className="space-y-2 w-full relative z-10">
                {label && <label className="text-xs font-bold text-lion-navy/70 ml-1 tracking-wide">{label}</label>}
                <input 
                    name={name} type={type} value={value} onChange={onChange} 
                    className={`w-full cute-input rounded-xl px-4 py-3.5 font-bold text-lion-navy placeholder-slate-300 ${error ? 'border-red-500 bg-red-50/50' : ''} ${className}`} 
                    placeholder={placeholder} {...props}
                />
            </div>
        );

        // --- Terms Modal ---
        const TermsModal = ({ isOpen, onClose, title, children, onAgree }) => {
            const contentRef = useRef(null);
            const [canAgree, setCanAgree] = useState(false);

            useEffect(() => {
                if (isOpen) {
                    setCanAgree(false);
                    document.body.style.overflow = 'hidden';
                    setTimeout(() => {
                        if (contentRef.current && contentRef.current.scrollHeight <= contentRef.current.clientHeight + 10) {
                            setCanAgree(true);
                        }
                    }, 300);
                } else {
                    document.body.style.overflow = '';
                }
            }, [isOpen]);

            const handleScroll = (e) => {
                const { scrollTop, scrollHeight, clientHeight } = e.target;
                if (scrollHeight - scrollTop - clientHeight < 50) setCanAgree(true);
            };

            if (!isOpen) return null;

return (
                <div className="fixed inset-0 z-[150] bg-lion-navy/40 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                    <div className="bg-white w-full max-w-lg rounded-3xl shadow-2xl flex flex-col max-h-[85vh] animate-slide-up">
                        <div className="px-6 py-5 border-b border-slate-100 flex justify-between items-center shrink-0">
                            <h3 className="text-lg font-serif font-bold text-lion-navy">{title}</h3>
                            <button onClick={onClose} className="p-2 bg-slate-50 rounded-full hover:bg-slate-100 transition-colors">
                                <Icon name="x" size={20} className="text-slate-400" />
                            </button>
                        </div>
                        <div ref={contentRef} onScroll={handleScroll} className="flex-1 overflow-y-auto p-6 text-sm text-slate-600 leading-relaxed space-y-4">
                            {children}
                            <div className="h-10"></div>
                        </div>
                        <div className="p-6 border-t border-slate-100 bg-white md:rounded-b-3xl shrink-0 safe-area-bottom">
                            {!canAgree && (
                                <div className="text-center text-xs font-bold text-lion-gold mb-3 animate-pulse">ğŸ‘‡ è«‹æ»‘å‹•è‡³æœ€åº•éƒ¨ä»¥åŒæ„æ¢æ¬¾</div>
                            )}
                            <button onClick={() => { if(canAgree) { onAgree && onAgree(); onClose(); } }} disabled={!canAgree}
                                className={`w-full py-4 rounded-xl font-bold text-base flex items-center justify-center gap-2 transition-all ${canAgree ? 'bg-lion-navy text-white shadow-lg shadow-lion-navy/20 active:scale-95 hover:bg-[#2A4B7C]' : 'bg-slate-100 text-slate-400 cursor-not-allowed'}`}>
                                <Icon name={canAgree ? "check-circle" : "lock"} size={20} />
                                {canAgree ? "æˆ‘å·²è©³é–±ä¸¦åŒæ„" : "è«‹é–±è®€å®Œç•¢"}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            const [view, setView] = useState('home');
            const [toast, setToast] = useState(null);
            
// å®Œæ•´è³‡æ–™ç‹€æ…‹
            const [formData, setFormData] = useState({
                lineAdded: false, email: '', owner_name: '', is_owner: 'æ˜¯', phone: '', owner_id: '', address: '',
                emergency_name: '', emergency_phone: '',
                preferred_clinic_name: '', preferred_clinic_phone: '',
                pet_name: '', breed: '', weight: '', age: '',
                pet_type: 'dog', sex: '', fix: '', chip_status: '', chip_id: '',
                health_date: '', deworming_monthly: '',
                physical_check: [], physical_other: '', 
                social_traits: [], personality_other: '',
                medical_history: 'ç„¡', medical_tags: [], medical_other: '',
                vet_name: '', vet_phone: '', // æ–°å¢é£¼ä¸»æŒ‡å®šé†«é™¢æ¬„ä½
                service_tags: [], room_type: '', room_price: '', checkInDate: '', checkOutDate: '',
                is_barking: '', has_boarding_exp: '', is_food_aggressive: '', use_peepad: '',
                vaccine_status: '', deworming_status: '', cage_training: '', temperament: '',
                food_allergy: '', personality_note: '', special_note: '', additional_notes: '',
                total_amount: '', payment_method: '', deposit: '', balance: '',
                signature: null, signature_time: '',
                legal_agree: false, service_type: ''
            });
            
const roomRates = {
                cat: [
                    { name: 'æ¨™æº–æˆ¿', price: 600, desc: 'èˆ’é©ç¨ç«‹ç©ºé–“' },
                    { name: 'è±ªè¯æˆ¿', price: 800, desc: 'è·³å°ç©å…·è±å¯Œ' },
                    { name: 'å®¶åº­æˆ¿', price: 1200, desc: 'å¤šè²“å…±äº«å¤§ç©ºé–“' }
                ],
                dog: [
                    { name: 'å°å‹çŠ¬æ¨™æº–æˆ¿', price: 500, desc: '5å…¬æ–¤ä»¥ä¸‹' },
                    { name: 'æ¨™æº–æˆ¿', price: 600, desc: 'ä¸€èˆ¬å°å‹çŠ¬' },
                    { name: 'è±ªè¯æˆ¿', price: 800, desc: 'å¯¬æ•ä¸æ“æ“ ' },
                    { name: 'VIPæˆ¿', price: 1300, desc: 'ç‰¹å¤§ç¨ç«‹ç©ºé–“' }
                ]
            };
            
            const personalityOptions = ['åˆ†é›¢ç„¦æ…®', 'ç·Šå¼µ', 'è†½å°', 'è­·é£Ÿ', '+ å…¶ä»–'];

            const [errors, setErrors] = useState({});
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [showSuccess, setShowSuccess] = useState(false);
            
            const [showFullSig, setShowFullSig] = useState(false);
            const [realtimeSig, setRealtimeSig] = useState(null);
            const fullSigCanvasRef = useRef(null);
            const padInstance = useRef(null);
            const [lineConfirmed, setLineConfirmed] = useState(false);

const [activeModal, setActiveModal] = useState(null);
            const [termsRead, setTermsRead] = useState({ beauty: false, boarding: false });

            const allTermsCompleted = useMemo(() => {
                if (!termsRead.beauty) return false;
                if (view === 'boarding' && !termsRead.boarding) return false;
                return true;
            }, [termsRead, view]);

            const handleTermAgree = (type) => {
                setTermsRead(prev => ({ ...prev, [type]: true }));
                // åŒæ„æ¢æ¬¾æ™‚è‡ªå‹•å°‡ legal_agree è¨­ç‚º true (å› ç‚ºç§»é™¤å‹¾é¸æ¡†äº†)
                setFormData(prev => ({ ...prev, legal_agree: true })); 
            };

            useEffect(() => {
                const handleHashChange = () => {
                    const hash = window.location.hash.slice(1);
                    if (['grooming', 'boarding', 'home'].includes(hash)) {
                        setView(hash);
                        window.scrollTo(0, 0);
                    } else {
                        setView('home');
                    }
                };
                window.addEventListener('hashchange', handleHashChange);
                handleHashChange();
                return () => window.removeEventListener('hashchange', handleHashChange);
            }, []);

            const updateHash = (newView) => window.location.hash = newView;
            
            const showToastMsg = (msg, type='error') => {
                setToast({ message: msg, type });
                setTimeout(() => setToast(null), 3000);
            };

            const handleChange = (field, value) => {
                setFormData(prev => ({ ...prev, [field]: value }));
                if (errors[field]) setErrors(prev => ({ ...prev, [field]: null }));
            };

            const toggleArray = (field, value) => {
                setFormData(prev => {
                    const arr = prev[field] || [];
                    return { ...prev, [field]: arr.includes(value) ? arr.filter(i=>i!==value) : [...arr, value] };
                });
            };

const validate = () => {
                const newErrors = {};
                const commonRequired = ['email', 'owner_name', 'phone', 'address', 'emergency_name', 'emergency_phone', 'pet_name', 'breed', 'weight', 'sex', 'fix', 'chip_status'];
                commonRequired.forEach(f => { if (!formData[f]) newErrors[f] = true; });

                if (view === 'grooming') {
                    if (!formData.temperament) newErrors.temperament = true;
                } else if (view === 'boarding') {
                    if (!formData.checkInDate) newErrors.checkInDate = true;
                    if (!formData.checkOutDate) newErrors.checkOutDate = true;
                    if (!formData.room_type) newErrors.room_type = true;
                }

                if (formData.chip_status === 'æœ‰æ™¶ç‰‡' && !formData.chip_id) newErrors.chip_id = true;

                // ä¿®æ­£é‡é»ï¼šå…ˆè¨­å®šéŒ¯èª¤ç‹€æ…‹ï¼Œè®“ç´…æ¡†é¡¯ç¤ºå‡ºä¾†
                setErrors(newErrors);

                // å¦‚æœæœ‰ç´…æ¡†éŒ¯èª¤ï¼Œç›´æ¥å›å‚³ false (é€™æ¨£ handleSubmit æœƒé¡¯ç¤ºã€Œè«‹æª¢æŸ¥ç´…æ¡†æ¬„ä½ã€)
                if (Object.keys(newErrors).length > 0) return false;

                // æ¥è‘—æ‰æª¢æŸ¥å…¶ä»–æ¢ä»¶
                if (!lineConfirmed) { showToastMsg('è«‹å…ˆå®Œæˆ LINE ç¢ºèª'); return false; }
                if (!allTermsCompleted) { showToastMsg('è«‹å…ˆå®Œæˆæ‰€æœ‰å¥‘ç´„æ¢æ¬¾é–±è®€'); return false; }
                if (!realtimeSig) { showToastMsg('è«‹å®Œæˆæ•¸ä½ç°½å'); return false; }

                return true;
            };

            const handleSubmit = async () => {
                if (!validate()) { showToastMsg('è«‹æª¢æŸ¥ç´…æ¡†æ¬„ä½'); window.scrollTo({ top: 200, behavior: 'smooth' }); return; }
                setIsSubmitting(true);
                await mockSubmit();
                setIsSubmitting(false);
                setShowSuccess(true);
            };

            useEffect(() => {
                let timer;
                const preventTouchMove = (e) => {
                    if (showFullSig) e.preventDefault();
                };

                const initCanvas = () => {
                    const canvas = fullSigCanvasRef.current;
                    if (!canvas) return;
                    
                    const container = canvas.parentElement;
                    const rect = container.getBoundingClientRect();
                    const ratio = Math.max(window.devicePixelRatio || 1, 1);
                    canvas.width = rect.width * ratio;
                    canvas.height = rect.height * ratio;
                    canvas.style.width = rect.width + 'px';
                    canvas.style.height = rect.height + 'px';
                    
                    const ctx = canvas.getContext("2d");
                    ctx.scale(ratio, ratio);
                    ctx.fillStyle = "rgb(255, 255, 255)";
                    ctx.fillRect(0, 0, rect.width, rect.height);
                    
                    if (padInstance.current) padInstance.current.off();
                    padInstance.current = new SignaturePad(canvas, { 
                        penColor: "rgb(27, 54, 93)", 
                        backgroundColor: "rgb(255, 255, 255)", 
                        minWidth: 1.5,
                        maxWidth: 4.0,
                    });
                };

                if (showFullSig) {
                    document.body.style.overflow = 'hidden';
                    document.addEventListener('touchmove', preventTouchMove, { passive: false });
                    timer = setTimeout(initCanvas, 150);
                }
                
                return () => { 
                    if (timer) clearTimeout(timer);
                    if (padInstance.current) padInstance.current.off(); 
                    document.body.style.overflow = '';
                    document.removeEventListener('touchmove', preventTouchMove);
                };
            }, [showFullSig]);

            const saveSignature = () => {
                if (padInstance.current && !padInstance.current.isEmpty()) {
                    setRealtimeSig(padInstance.current.toDataURL());
                    const now = new Date();
                    const timeStr = `${now.getFullYear()}/${(now.getMonth()+1).toString().padStart(2,'0')}/${now.getDate().toString().padStart(2,'0')} ${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}`;
                    handleChange('signature', padInstance.current.toDataURL());
                    handleChange('signature_time', timeStr);
                    setShowFullSig(false);
                } else {
                    showToastMsg('è«‹å…ˆç°½å');
                }
            };

            // --- Home View (å®Œå…¨ä¿ç•™) ---
            if (view === 'home') {
                return (
                    <div className="min-h-screen relative flex flex-col font-sans">
                        <main className="flex-1 px-6 pb-10 max-w-lg mx-auto w-full pt-12 md:pt-20">
                            <div className="text-center mb-10 animate-fade-in relative z-10">
                                <img src="logo.png" className="w-72 md:w-96 h-auto mx-auto object-contain drop-shadow-lg mb-6 hover:scale-105 transition-transform duration-500" onError={(e)=>{e.target.style.display='none'}} />
                                <p className="text-lion-gold text-[10px] font-bold tracking-[0.4em] uppercase">Luxury Pet Salon</p>
                            </div>
                            <Marquee />
                            <div className="space-y-5 animate-fade-in" style={{animationDelay:'0.1s'}}>
                                <div onClick={() => updateHash('grooming')} className="glass-premium p-6 flex items-center gap-6 cursor-pointer hover:shadow-lg hover:border-lion-gold/30 transition-all border border-white group">
                                    <div className="w-16 h-16 bg-white rounded-2xl flex items-center justify-center text-lion-navy shadow-sm border border-slate-50 group-hover:bg-lion-navy group-hover:text-white transition-colors relative z-10"><Icon name="scissors" size={28} /></div>
                                    <div className="flex-1 relative z-10">
                                        <h3 className="text-xl font-serif font-bold text-lion-navy group-hover:text-lion-gold transition-colors">ç²¾ç·»ç¾å®¹</h3>
                                        <p className="text-slate-500 text-xs mt-1">å°ˆæ¥­é€ å‹ä¿®å‰ª Â· æ·±å±¤çš®æ¯›è­·ç†</p>
                                    </div>
                                    <div className="w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center group-hover:bg-lion-gold group-hover:text-white transition-colors relative z-10"><Icon name="chevron-right" size={16} /></div>
                                </div>
                                <div onClick={() => updateHash('boarding')} className="glass-premium p-6 flex items-center gap-6 cursor-pointer hover:shadow-lg hover:border-lion-gold/30 transition-all border border-white group">
                                    <div className="w-16 h-16 bg-[#F9F5EC] rounded-2xl flex items-center justify-center text-lion-gold shadow-sm border border-slate-50 group-hover:bg-lion-gold group-hover:text-white transition-colors relative z-10"><Icon name="home" size={28} /></div>
                                    <div className="flex-1 relative z-10">
                                        <h3 className="text-xl font-serif font-bold text-lion-navy group-hover:text-lion-gold transition-colors">ç²¾å“ä½å®¿</h3>
                                        <p className="text-slate-500 text-xs mt-1">å¯¬æ•ç¨ç«‹ç©ºé–“ Â· 24H æº«æ¿•åº¦ç›£æ§</p>
                                    </div>
                                    <div className="w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center group-hover:bg-lion-gold group-hover:text-white transition-colors relative z-10"><Icon name="chevron-right" size={16} /></div>
                                </div>
                            </div>
                            <div className="mt-8 grid grid-cols-3 gap-4 animate-fade-in" style={{animationDelay:'0.2s'}}>
                                <a href="tel:033608693" className="glass-premium p-4 flex flex-col items-center justify-center gap-2 hover:-translate-y-1 transition-transform border border-white group">
                                    <Icon name="phone" className="text-slate-400 group-hover:text-lion-navy transition-colors" /><span className="text-[10px] font-bold text-lion-navy">æ’¥æ‰“é›»è©±</span>
                                </a>
                                <a href="https://www.facebook.com/lionbeautycasa/?locale=zh_TW" target="_blank" className="glass-premium p-4 flex flex-col items-center justify-center gap-2 hover:-translate-y-1 transition-transform border border-white group">
                                    <Icon name="facebook" className="text-[#1877F2]" /><span className="text-[10px] font-bold text-lion-navy">Facebook</span>
                                </a>
                                <a href="https://lin.ee/jS3JP5z" className="glass-premium p-4 flex flex-col items-center justify-center gap-2 hover:-translate-y-1 transition-transform border border-white group">
                                    <img src="https://lionpetsstore.github.io/line.png" className="w-5 h-5 object-contain" /><span className="text-[10px] font-bold text-lion-navy">åŠ å¥½å‹</span>
                                </a>
                            </div>
                            <div className="mt-8 text-center animate-fade-in" style={{animationDelay:'0.3s'}}>
                                <a href="https://maps.app.goo.gl/Kc4xdPe2KowoLcUR9" target="_blank" className="inline-flex items-center gap-2 text-lion-navy font-bold text-sm bg-white/80 backdrop-blur px-5 py-3 rounded-full shadow-sm border border-slate-100 hover:scale-105 hover:shadow-md hover:border-lion-gold/50 transition-all">
                                    <Icon name="map-pin" size={18} className="text-lion-gold"/> æ¡ƒåœ’å¸‚æ¡ƒåœ’å€æ°‘æ—è·¯199-2è™Ÿ
                                </a>
                            </div>
                        </main>
                        <footer className="text-center py-8 text-[10px] text-slate-400 font-bold relative z-10"><p>ç‰¹å¯µæ¥­å­—ç¬¬ C1130686 è™Ÿ</p><p className="mt-1">Â© 2026 Lion Pet Beauty Casa.</p></footer>
                    </div>
                );
            }

            // --- Form Views ---
            return (
                <div className="min-h-screen pb-40">
                    {toast && <Toast message={toast.message} type={toast.type} />}
                    <nav className="fixed top-0 w-full z-40 bg-white/80 backdrop-blur-md border-b border-slate-200/50 shadow-sm transition-all">
                        <div className="px-6 py-4 flex justify-between items-center max-w-5xl mx-auto">
                            <div className="flex items-center gap-4 cursor-pointer group" onClick={() => updateHash('home')}>
                                <img src="logo.png" className="w-10 h-10 object-contain" onError={(e)=>{e.target.style.display='none'}}/> 
                                <span className="font-serif font-bold text-lion-navy text-lg hidden md:block">LION PET</span>
                            </div>
                            <button onClick={() => updateHash('home')} className="text-xs font-bold text-slate-600 bg-slate-100/80 px-4 py-2.5 rounded-full flex items-center gap-2 hover:bg-slate-200 transition-colors"><Icon name="arrow-left" size={16}/> è¿”å›é¦–é </button>
                        </div>
                    </nav>

                    <main className="pt-28 px-4 md:px-8 max-w-4xl mx-auto space-y-8">
                        <div className="text-center space-y-2 mb-8 relative z-10">
                            <h2 className="text-2xl md:text-3xl font-serif font-bold text-lion-navy drop-shadow-sm">{view === 'boarding' ? 'ä½å®¿æœå‹™å¡«å¯«è³‡æ–™' : 'ç¾å®¹æœå‹™å¡«å¯«è³‡æ–™'}</h2>
                            <p className="text-sm text-slate-500 font-medium">è«‹å¡«å¯«ä»¥ä¸‹è³‡è¨Šä»¥å®Œæˆé ç´„</p>
                        </div>

                        <div className="glass-premium p-6 md:p-8 border-l-4 border-lion-line shadow-sm">
                            <div className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6">
                                <div>
                                    <h3 className="font-bold text-lion-navy text-xl flex items-center gap-2"><img src="https://lionpetsstore.github.io/line.png" className="w-7 h-7"/> åŠ å…¥å®˜æ–¹ LINE</h3>
                                    <p className="text-sm text-slate-500 font-bold mt-1 ml-9">ID: @149veapq</p>
                                </div>
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <a href="https://lin.ee/jS3JP5z" className="bg-slate-50/50 rounded-2xl p-4 text-center border hover:bg-white transition-colors group">
                                    <div className="w-8 h-8 bg-lion-line text-white rounded-full flex items-center justify-center text-sm font-bold mx-auto mb-2 shadow-sm group-hover:scale-110 transition-transform">1</div><div className="text-base font-bold text-lion-line">é»æ“ŠåŠ å…¥å¥½å‹</div>
                                </a>
                                <div className="bg-red-50/50 rounded-2xl p-4 text-center border border-red-100">
                                    <div className="w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center text-sm font-bold mx-auto mb-2 shadow-sm animate-pulse-slow">2</div><div className="text-base font-bold text-red-600">å‹™å¿…ã€Œå‚³é€è²¼åœ–ã€</div>
                                </div>
                            </div>
                            <button onClick={() => setLineConfirmed(!lineConfirmed)} className={`w-full py-4 rounded-xl font-bold text-sm border transition-all ${lineConfirmed ? 'bg-lion-line text-white border-lion-line shadow-md' : 'bg-white text-slate-400 border-slate-300 hover:bg-slate-50'}`}>{lineConfirmed ? "âœ… æˆ‘å·²å®Œæˆä¸Šè¿°å…©æ­¥é©Ÿ" : "ç¢ºèªï¼šæˆ‘å·²å®Œæˆä¸Šè¿°å…©æ­¥é©Ÿ"}</button>
                        </div>

                        {view === 'boarding' && (
                            <section className="glass-premium p-6 md:p-8 space-y-5">
                                <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-3 flex items-center gap-2 text-lg"><Icon name="home" size={20}/> ä½å®¿ç’°å¢ƒä»‹ç´¹</h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div className="bg-[#FFF8E1]/60 p-5 rounded-2xl border border-[#FFE082]/30 backdrop-blur-sm"><h4 className="font-bold text-lion-navy mb-2 flex items-center gap-2 text-base"><Icon name="cat" size={18}/> ä¸€æ¨“ï¼šè²“å’ªä½å®¿</h4><p className="text-sm text-slate-600 leading-relaxed text-justify">è²“å’ªå°ˆå±¬æ¨“å±¤ï¼Œæ¯æ—¥æ¶ˆæ¯’ã€æ†æº«èˆ’é©ã€‚ç¨ç«‹ç©ºèª¿å¾ªç’°ï¼Œè®“è²“è²“å€‘èƒ½è‡ªåœ¨æ›¬å¤ªé™½ã€çª©åœ¨æŸ”è»Ÿçš„æ¯¯å­è£¡ç™¼å‘†ã€‚</p></div>
                                    <div className="bg-[#E3F2FD]/60 p-5 rounded-2xl border border-[#90CAF9]/30 backdrop-blur-sm"><h4 className="font-bold text-lion-navy mb-2 flex items-center gap-2 text-base"><Icon name="dog" size={18}/> äºŒæ¨“ï¼šç‹—ç‹—ä½å®¿</h4><p className="text-sm text-slate-600 leading-relaxed text-justify">æ¯æ—¥é™ªç©ã€å®šæ™‚æ•£æ­¥ã€‚å¤œé–“ä¿å§†å·¡æˆ¿ï¼Œä¸åªæ˜¯ã€Œå¯„æ”¾ã€ï¼Œè€Œæ˜¯è¢«ç…§é¡§ã€è¢«ç–¼æ„›ã€è¢«é™ªä¼´ã€‚</p></div>
                                </div>
                            </section>
                        )}

                        <section className="glass-premium p-6 md:p-8 space-y-6">
                            <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-4 flex items-center gap-3 text-lg"><Icon name="user" size={20}/> é£¼ä¸»åŸºæœ¬è³‡æ–™</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <InputWithError label="é›»å­éƒµä»¶ *" name="email" type="email" value={formData.email} onChange={e=>handleChange('email', e.target.value)} error={errors.email} placeholder="å¯„é€å¥‘ç´„å‰¯æœ¬ç”¨" />
                                <div className="grid grid-cols-[1.5fr,1fr] gap-4">
                                    <InputWithError label="ä¸»äººå§“å *" name="owner_name" value={formData.owner_name} onChange={e=>handleChange('owner_name', e.target.value)} error={errors.owner_name} />
                                    <div className="space-y-2"><label className="text-xs font-bold text-lion-navy/70 ml-1">æ˜¯å¦ç‚ºæœ¬äºº *</label><div className="flex gap-2 h-[50px]">{['æ˜¯','å¦'].map(opt=><button key={opt} onClick={()=>handleChange('is_owner', opt)} className={`flex-1 rounded-xl text-xs font-bold border transition-all ${formData.is_owner===opt?'bg-lion-navy text-white border-lion-navy shadow-md':'bg-white text-slate-400 border-slate-200 hover:border-slate-300'}`}>{opt}</button>)}</div></div>
                                </div>
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="flex gap-3 items-end"><div className="flex-1"><InputWithError label="é€£çµ¡é›»è©± *" name="phone" type="tel" value={formData.phone} onChange={e=>handleChange('phone', e.target.value)} error={errors.phone} /></div><button className="bg-lion-navy text-white h-[50px] px-4 rounded-xl font-bold text-xs shadow-md hover:bg-blue-900 transition-colors whitespace-nowrap">èˆŠå®¢æŸ¥è©¢</button></div>
                                <InputWithError label={view==='boarding' ? "èº«åˆ†è­‰å­—è™Ÿ (å…¥ä½è«‹æ”œå¸¶æ­£æœ¬æ ¸å°) *" : "èº«åˆ†è­‰å­—è™Ÿ *"} name="owner_id" value={formData.owner_id} onChange={e=>handleChange('owner_id', e.target.value)} />
                            </div>
                            <InputWithError label="é€šè¨Šåœ°å€ *" name="address" value={formData.address} onChange={e=>handleChange('address', e.target.value)} error={errors.address} />
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-red-50/50 rounded-2xl border border-red-100">
                                <InputWithError label="ç·Šæ€¥è¯çµ¡äºº(éé£¼ä¸»æœ¬äºº) *" name="emergency_name" value={formData.emergency_name} onChange={e=>handleChange('emergency_name', e.target.value)} error={errors.emergency_name} className="bg-white/80" />
                                <InputWithError label="ç·Šæ€¥é›»è©± *" name="emergency_phone" value={formData.emergency_phone} onChange={e=>handleChange('emergency_phone', e.target.value)} error={errors.emergency_phone} className="bg-white/80" />
                            </div>
                        </section>

                        <section className="glass-premium p-6 md:p-8 space-y-6">
                            <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-4 flex items-center gap-3 text-lg"><Icon name="paw-print" size={20}/> å¯µç‰©è©³ç´°è³‡æ–™</h3>
                            
                            <div className="flex p-1 bg-slate-100 rounded-xl mb-4">
                                <button 
                                    onClick={() => { handleChange('pet_type', 'dog'); handleChange('room_type', ''); handleChange('room_price', ''); }}
                                    className={`flex-1 py-3 rounded-lg text-sm font-bold flex items-center justify-center gap-2 transition-all ${formData.pet_type === 'dog' ? 'bg-lion-navy text-white shadow-md' : 'text-slate-400 hover:text-lion-navy'}`}
                                >
                                    <Icon name="dog" size={18}/> ç‹—ç‹—
                                </button>
                                <button 
                                    onClick={() => { handleChange('pet_type', 'cat'); handleChange('room_type', ''); handleChange('room_price', ''); }}
                                    className={`flex-1 py-3 rounded-lg text-sm font-bold flex items-center justify-center gap-2 transition-all ${formData.pet_type === 'cat' ? 'bg-lion-navy text-white shadow-md' : 'text-slate-400 hover:text-lion-navy'}`}
                                >
                                    <Icon name="cat" size={18}/> è²“å’ª
                                </button>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <InputWithError label="å¯µç‰©åå­— *" name="pet_name" value={formData.pet_name} onChange={e=>handleChange('pet_name', e.target.value)} error={errors.pet_name} />
                                <InputWithError label="å“ç¨® *" name="breed" value={formData.breed} onChange={e=>handleChange('breed', e.target.value)} error={errors.breed} />
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <InputWithError label="é«”é‡ (kg) *" name="weight" type="number" value={formData.weight} onChange={e=>handleChange('weight', e.target.value)} error={errors.weight} />
                                <div className="space-y-2">
                                    <label className="text-xs font-bold text-slate-500">å¹´é½¡ *</label>
                                    <input type="text" className="w-full cute-input rounded-xl px-4 py-3" placeholder="ä¾‹: 3æ­² æˆ– 5å€‹æœˆ" value={formData.age} onChange={e=>handleChange('age', e.target.value)} />
                                </div>
                            </div>
<div className="grid grid-cols-2 gap-6">
                                <div className="space-y-2"><label className="text-xs font-bold text-slate-500">æ€§åˆ¥ *</label><div className="flex gap-2">{['å…¬','æ¯'].map(v=>(<button key={v} onClick={()=>handleChange('sex',v)} className={`flex-1 py-3 rounded-xl border text-sm font-bold transition-all ${formData.sex===v?'bg-lion-navy text-white border-lion-navy': (errors.sex ? 'bg-red-50 border-red-500 text-red-500' : 'bg-white/50 text-slate-500 border-slate-300')}`}>{v}</button>))}</div></div>
                                <div className="space-y-2"><label className="text-xs font-bold text-slate-500">çµç´® *</label><div className="flex gap-2">{['æ˜¯','å¦'].map(v=>(<button key={v} onClick={()=>handleChange('fix',v)} className={`flex-1 py-3 rounded-xl border text-sm font-bold transition-all ${formData.fix===v?'bg-lion-navy text-white border-lion-navy': (errors.fix ? 'bg-red-50 border-red-500 text-red-500' : 'bg-white/50 text-slate-500 border-slate-300')}`}>{v}</button>))}</div></div>
                            </div>
                            <div className="grid grid-cols-2 gap-6">
                                <div className="space-y-2"><label className="text-xs font-bold text-slate-500">è¿‘æœŸå¥æª¢</label><input type="date" className="w-full cute-input rounded-xl px-2 py-3 text-xs" value={formData.health_date} onChange={e=>handleChange('health_date', e.target.value)} /></div>
                                <div className="space-y-2"><label className="text-xs font-bold text-slate-500">æ¯æœˆå®šæœŸé©…èŸ²</label><div className="flex gap-2 h-[48px]">{['æ˜¯','å¦'].map(v=><button key={v} onClick={()=>handleChange('deworming_monthly',v)} className={`flex-1 rounded-xl border-2 text-xs font-bold ${formData.deworming_monthly===v?'bg-lion-navy text-white border-lion-navy':'bg-white text-slate-400 border-slate-200'}`}>{v}</button>)}</div></div>
                            </div>
                            <div className="space-y-2">
                                <label className="text-xs font-bold text-slate-500">å¤–è§€æª¢æŸ¥ (å¯è¤‡é¸)</label>
                                <div className="flex flex-wrap gap-2">
                                    {['æ­£å¸¸', 'çš®å±‘', 'æ‰“çµ', 'ç´…è…«', 'å¯„ç”ŸèŸ²(è·³èš¤ã€å£è¨)', '+ å…¶ä»–'].map(opt => (
                                        <button key={opt} onClick={() => {
                                            let newArr = [...formData.physical_check];
                                            if (opt === 'æ­£å¸¸') { newArr = newArr.includes('æ­£å¸¸') ? [] : ['æ­£å¸¸']; } 
                                            else { if (newArr.includes('æ­£å¸¸')) newArr = []; newArr = newArr.includes(opt) ? newArr.filter(i => i !== opt) : [...newArr, opt]; }
                                            handleChange('physical_check', newArr);
                                        }} className={`px-4 py-2.5 rounded-xl text-xs font-bold border-2 transition-all ${formData.physical_check.includes(opt) ? 'bg-lion-navy text-white border-lion-navy shadow-md' : 'bg-white text-slate-500 border-slate-200 hover:border-lion-gold'}`}>{opt}</button>
                                    ))}
                                </div>
                                {formData.physical_check.includes('+ å…¶ä»–') && <InputWithError placeholder="è«‹èªªæ˜å…¶ä»–å¤–è§€ç‹€æ³" value={formData.physical_other} onChange={e=>handleChange('physical_other', e.target.value)} className="animate-slide-down" />}
                            </div>

                            <div className="space-y-3">
                                <label className="text-xs font-bold text-lion-navy/70 ml-1">å¯µç‰©å€‹æ€§</label>
                                <div className="space-y-3 p-4 bg-white/50 rounded-2xl border border-slate-100">
                                    <div className="flex gap-3">{['è¦ªäºº','ä¸è¦ªäºº'].map(opt=><button key={opt} onClick={()=>{const clean=formData.social_traits.filter(t=>!['è¦ªäºº','ä¸è¦ªäºº'].includes(t)); handleChange('social_traits',[...clean,opt]);}} className={`flex-1 py-3 rounded-xl text-xs font-bold border-2 transition-all ${formData.social_traits.includes(opt)?'bg-lion-navy text-white border-lion-navy shadow-md':'bg-white text-slate-500 border-slate-200'}`}>{opt}</button>)}</div>
                                    <div className="flex gap-3">{['è¦ªç‹—','ä¸è¦ªç‹—'].map(opt=><button key={opt} onClick={()=>{const clean=formData.social_traits.filter(t=>!['è¦ªç‹—','ä¸è¦ªç‹—'].includes(t)); handleChange('social_traits',[...clean,opt]);}} className={`flex-1 py-3 rounded-xl text-xs font-bold border-2 transition-all ${formData.social_traits.includes(opt)?'bg-lion-navy text-white border-lion-navy shadow-md':'bg-white text-slate-500 border-slate-200'}`}>{opt}</button>)}</div>
                                    <div className="flex flex-wrap gap-2">{personalityOptions.map(opt=><button key={opt} onClick={()=>toggleArray('social_traits', opt)} className={`px-4 py-2.5 rounded-xl text-xs font-bold border-2 transition-all ${formData.social_traits.includes(opt)?'bg-lion-navy text-white border-lion-navy shadow-md':'bg-white text-slate-500 border-slate-200 hover:border-lion-gold'}`}>{opt}</button>)}</div>
                                    {formData.social_traits.includes('+ å…¶ä»–') && <InputWithError placeholder="è«‹èªªæ˜å…¶ä»–å€‹æ€§ç‹€æ³" value={formData.personality_other} onChange={e=>handleChange('personality_other', e.target.value)} className="animate-slide-down" />}
                                </div>
                            </div>
                            
                            {view === 'boarding' && (
                                <div className="space-y-3">
                                    <label className="text-xs font-bold text-lion-navy/70 ml-1">æ”¾é¢¨æ¨¡å¼</label>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div onClick={()=>handleChange('temperament','å…±åŒæ”¾é¢¨')} className={`radio-card p-4 rounded-xl cursor-pointer flex items-center justify-between group ${formData.temperament==='å…±åŒæ”¾é¢¨'?'selected':''}`}><div><div className="font-bold text-sm text-lion-navy">å…±åŒæ”¾é¢¨</div><div className="text-[10px] text-slate-400 mt-1">ç„¡æ”»æ“Šæ€§ã€ç„¡ä»»ä½•å‚³æŸ“ç–¾ç—…ï¼Œå¯èˆ‡å…¶ä»–å¤¥ä¼´ç›¸è™•</div></div>{formData.temperament==='å…±åŒæ”¾é¢¨' && <Icon name="check-circle" className="text-lion-navy" size={18}/>}</div>
                                        <div onClick={()=>handleChange('temperament','ç¨ç«‹æ”¾é¢¨')} className={`radio-card p-4 rounded-xl cursor-pointer flex items-center justify-between group ${formData.temperament==='ç¨ç«‹æ”¾é¢¨'?'selected':''}`}><div><div className="font-bold text-sm text-lion-navy">ç¨ç«‹æ”¾é¢¨</div><div className="text-[10px] text-slate-400 mt-1">ç”±åº—å®¶å®‰æ’ç‰¹å®šæ™‚é–“å–®ç¨æ´»å‹•</div></div>{formData.temperament==='ç¨ç«‹æ”¾é¢¨' && <Icon name="check-circle" className="text-lion-navy" size={18}/>}</div>
                                    </div>
                                </div>
                            )}

<div className="space-y-2">
                                <label className="text-xs font-bold text-lion-navy/70 ml-1">æ™¶ç‰‡ç‹€æ…‹</label>
                                <div className="flex flex-wrap gap-2">
                                    {['æœ‰æ™¶ç‰‡', 'æœ‰æ™¶ç‰‡(è™Ÿç¢¼ä¸è©³)', 'ç„¡æ™¶ç‰‡'].map(v => (
                                        <button key={v} onClick={() => handleChange('chip_status', v)} 
                                            className={`px-4 py-3 rounded-xl border-2 text-xs font-bold transition-all flex-grow ${formData.chip_status === v ? 'bg-lion-navy text-white border-lion-navy shadow-md' : (errors.chip_status ? 'bg-red-50 border-red-500 text-red-500' : 'bg-white text-slate-500 border-slate-200')}`}>
                                            {v}
                                        </button>
                                    ))}
                                </div>
                                {formData.chip_status === 'æœ‰æ™¶ç‰‡' && <InputWithError placeholder="è«‹è¼¸å…¥æ™¶ç‰‡è™Ÿç¢¼" value={formData.chip_id} onChange={e => handleChange('chip_id', e.target.value)} className="animate-slide-down mt-2" />}
                            </div>

                            <div className="space-y-3 pt-4 border-t border-slate-100">
                                <label className="text-xs font-bold text-slate-500">éå¾€ç—…å² (å¯è¤‡é¸) *</label>
                                <div className="flex gap-2">
                                    <button onClick={()=>handleChange('medical_history', 'æœ‰')} className={`flex-1 py-3 rounded-xl border font-bold transition-all flex items-center justify-center gap-2 ${formData.medical_history==='æœ‰' ? 'bg-lion-navy text-white border-lion-navy shadow-md' : 'bg-white/50 text-slate-400 border-slate-200 hover:border-lion-gold'}`}><Icon name="check-circle" size={18} className="mb-0.5"/> æœ‰</button>
                                    <button onClick={()=>{handleChange('medical_history', 'ç„¡'); handleChange('medical_tags', []);}} className={`flex-1 py-3 rounded-xl border font-bold transition-all ${formData.medical_history==='ç„¡' ? 'bg-slate-100 text-slate-600 border-slate-200' : 'bg-white/50 text-slate-400 border-slate-200 hover:border-slate-300'}`}>ç„¡</button>
                                </div>
                                {formData.medical_history === 'æœ‰' && <div className="animate-slide-down space-y-3 bg-slate-50/50 p-5 rounded-2xl border border-slate-200"><div className="flex flex-wrap gap-2">{['å¿ƒè‡Ÿç—…','ç™²ç™‡','éæ•','æ°£å–˜','çš®è†šç—…','æ°£ç®¡å¡Œé™·','ç™½å…§éšœ','å¿ƒçµ²èŸ²','è…¹è†œç‚','è…¹ç©æ°´','è‰¾åˆ©å¸Œé«”','æ‰‹è¡“å¤–å‚·æœªç™’åˆ','é«–é—œç¯€å•é¡Œ','éª¨æŠ˜','è…¸ç‚','è¡€ä¾¿','è¡€å°¿','æ‡·å­•','å‚³æŸ“æ€§ç–¾ç—…','+ å…¶ä»–'].map(tag => (<button key={tag} onClick={()=>toggleArray('medical_tags', tag)} className={`px-3 py-1.5 rounded-lg text-xs font-bold border transition-all ${formData.medical_tags.includes(tag) ? (tag === '+ å…¶ä»–' ? 'bg-lion-gold text-white border-lion-gold' : 'bg-lion-navy text-white border-lion-navy') : 'bg-white text-slate-500 border-slate-200 hover:border-lion-navy/30'}`}>{tag}</button>))}</div>{formData.medical_tags.includes('+ å…¶ä»–') && <textarea className="w-full cute-input rounded-xl px-4 py-3 h-20 text-sm animate-fade-in focus:border-lion-gold" placeholder="è«‹è©³ç´°èªªæ˜å…¶ä»–ç—…å²..." value={formData.medical_other} onChange={e=>handleChange('medical_other', e.target.value)}></textarea>}</div>}
                            </div>
                            
                            <div className="space-y-2">
                                <label className="text-xs font-bold text-slate-500">é£¼ä¸»æŒ‡å®šé†«ç™‚é™¢æ‰€</label>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <InputWithError label="é†«é™¢åç¨±" name="preferred_clinic_name" value={formData.preferred_clinic_name || ''} onChange={e=>handleChange('preferred_clinic_name', e.target.value)} placeholder="ä¾‹ï¼šå°å¤§å‹•ç‰©é†«é™¢" />
                                    <InputWithError label="è¯çµ¡é›»è©±" name="preferred_clinic_phone" value={formData.preferred_clinic_phone || ''} onChange={e=>handleChange('preferred_clinic_phone', e.target.value)} placeholder="ä¾‹ï¼š03-123-4567" />
                                </div>
                            </div>
                        </section>

{/* æ¶ˆè²»é …ç›® */}
                        <section className="glass-premium p-6 md:p-8 space-y-6">
                            <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-4 flex items-center gap-3 text-lg"><div className="w-8 h-8 rounded-lg bg-lion-navy/10 flex items-center justify-center text-lion-navy"><Icon name="shopping-bag" size={18}/></div> æ¶ˆè²»é …ç›® (å¯è¤‡é¸)</h3>
                            
                            {view === 'boarding' && (
                                <div className="space-y-6 animate-slide-down border-b border-slate-200 pb-6">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 bg-lion-gold/10 p-5 rounded-2xl border border-lion-gold/20">
                                        <div className="space-y-1"><label className="text-xs font-bold text-lion-navy">å…¥ä½æ—¥æœŸ *</label><input type="date" className="w-full cute-input rounded-xl px-4 py-3 text-sm" value={formData.checkInDate} onChange={e=>handleChange('checkInDate', e.target.value)} /></div>
                                        <div className="space-y-1"><label className="text-xs font-bold text-lion-navy">é€€æˆ¿æ—¥æœŸ *</label><input type="date" className="w-full cute-input rounded-xl px-4 py-3 text-sm" value={formData.checkOutDate} onChange={e=>handleChange('checkOutDate', e.target.value)} /></div>
                                    </div>

                                    <div className="space-y-3">
                                        <label className="text-xs font-bold text-slate-500 ml-1">é¸æ“‡æˆ¿å‹ ({formData.pet_type === 'dog' ? 'ç‹—ç‹—' : 'è²“å’ª'}) *</label>
                                        <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
{roomRates[formData.pet_type].map((room) => (
                                                <div 
                                                    key={room.name}
                                                    onClick={() => { handleChange('room_type', room.name); handleChange('room_price', room.price); }}
                                                    className={`cursor-pointer rounded-xl p-4 border-2 transition-all relative overflow-hidden group ${formData.room_type === room.name ? 'border-lion-navy bg-white shadow-md' : (errors.room_type ? 'border-red-500 bg-red-50/50' : 'border-slate-200 bg-white/50 hover:border-lion-gold')}`}
                                                >
                                                    <div className="flex justify-between items-start mb-1">
                                                        <span className={`font-bold text-sm ${formData.room_type === room.name ? 'text-lion-navy' : 'text-slate-600'}`}>{room.name}</span>
                                                        {formData.room_type === room.name && <Icon name="check-circle" size={16} className="text-lion-gold"/>}
                                                    </div>
                                                    <div className="text-lg font-serif font-bold text-lion-navy">${room.price}<span className="text-xs font-sans font-normal text-slate-400">/æ™š</span></div>
                                                    <div className="text-[10px] text-slate-400 mt-1 font-medium">{room.desc}</div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            )}

                            <div className="space-y-6">
                                <div>
                                    <div className="text-xs font-bold text-slate-400 mb-3 tracking-wide">åŸºç¤æœå‹™</div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        {['æ´—æ¾¡', 'å‰ªæ¯›(å«æ´—æ¾¡)'].map(item => (<button key={item} onClick={()=>toggleArray('service_tags', item)} className={`p-4 rounded-2xl border-2 text-left transition-all ${formData.service_tags.includes(item) ? 'border-lion-navy bg-lion-navy text-white shadow-lg' : 'border-slate-200 bg-white hover:border-lion-gold'}`}><div className="font-bold text-sm">{item}</div><div className="text-[10px] opacity-70 mt-1">åŸºç¤æ¸…æ½”è­·ç†</div></button>))}
                                    </div>
                                </div>
                                <div>
                                    <div className="text-xs font-bold text-slate-400 mb-3 tracking-wide">åŠ è³¼èˆ‡å‡ç´š</div>
                                    <div className="grid grid-cols-2 md:grid-cols-3 gap-3">
                                        {[
                                            {n:'åˆ·ç‰™', p:'$50'},
                                            {n:'æ•£æ­¥', p:'$100', note:'(è«‹è‡ªå‚™ä¸æœƒæ™è„«ä¹‹èƒ¸èƒŒç‰½ç¹©)', isRed:true},
                                            {n:'ç‰›å¥¶æµ´', p:'$200èµ·'}, 
                                            {n:'é…µç´ ', p:'$200èµ·'}, 
                                            {n:'ä¿®é ­', p:'$300èµ·'}, 
                                            {n:'å…¨èº«æ‰‹å‰ª', p:'$600èµ·'},
                                        ].map(item => (
                                            <button key={item.n} onClick={()=>toggleArray('service_tags', item.n)} className={`flex flex-col items-start p-3 md:p-4 rounded-xl border-2 text-xs font-bold transition-all relative overflow-hidden ${formData.service_tags.includes(item.n) ? 'bg-lion-gold text-white border-lion-gold shadow-md' : 'bg-white text-slate-600 border-slate-200 hover:border-lion-gold/50'}`}>
                                                <div className="flex justify-between w-full relative z-10"><span>{item.n}</span><span className="opacity-80">{item.p}</span></div>
                                                {item.note && <div className={`text-[9px] mt-1 relative z-10 text-left ${item.isRed ? (formData.service_tags.includes(item.n) ? 'text-white' : 'text-red-500 font-bold') : 'opacity-70'}`}>{item.note}</div>}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                                <div>
                                    <div className="text-xs font-bold text-slate-400 mb-3 tracking-wide">å…¶ä»–é …ç›®</div>
                                    <div className="flex gap-3">
                                        <button onClick={()=>toggleArray('service_tags', 'å…¶ä»–')} className={`w-full py-3 rounded-xl text-xs font-bold border-2 transition-all ${formData.service_tags.includes('å…¶ä»–')?'bg-slate-600 text-white border-slate-600 shadow-md':'bg-white text-slate-500 border-slate-200 hover:bg-slate-50'}`}>å…¶ä»–</button>
                                    </div>
                                </div>
                                {formData.service_tags.includes('å…¶ä»–') && (
                                    <div className="animate-slide-down">
                                        <InputWithError label="å‚™è¨»èªªæ˜" name="note" value={formData.note} onChange={e=>handleChange('note', e.target.value)} placeholder="é‡å°ä¸Šè¿°é …ç›®è£œå……èªªæ˜..." />
                                    </div>
                                )}
                            </div>
                        </section>

                        {/* ä»˜æ¬¾è³‡è¨Š */}
                        <section className="glass-premium p-6 md:p-8 space-y-6">
                            <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-4 flex items-center gap-3 text-lg"><div className="w-8 h-8 rounded-lg bg-lion-navy/10 flex items-center justify-center text-lion-navy"><Icon name="dollar-sign" size={18}/></div> ä»˜æ¬¾èˆ‡é‡‘é¡ç¢ºèª</h3>
                            <InputWithError label="æœ¬æ¬¡æ¶ˆè²»ç¸½é‡‘é¡" type="number" name="total_amount" value={formData.total_amount} onChange={e=>handleChange('total_amount', e.target.value)} placeholder="ç”±åº—å®¶å‘ŠçŸ¥é‡‘é¡å¾Œå¡«å¯«" />
                            <div className="space-y-2"><label className="text-xs font-bold text-lion-navy/70 ml-1">ä»˜æ¬¾æ–¹å¼</label><div className="flex gap-3">{['ç¾é‡‘','è½‰å¸³'].map(opt=><button key={opt} onClick={()=>handleChange('payment_method',opt)} className={`flex-1 py-3.5 rounded-xl border-2 text-sm font-bold transition-all ${formData.payment_method===opt?'bg-lion-navy text-white border-lion-navy shadow-md':'bg-white text-slate-500 border-slate-200 hover:border-slate-300'}`}>{opt}</button>)}</div></div>
                            {view === 'boarding' && (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 animate-slide-down">
                                    <InputWithError label="å·²æ”¯ä»˜è¨‚é‡‘" type="number" name="deposit" value={formData.deposit} onChange={e=>handleChange('deposit', e.target.value)} placeholder="$0" />
                                    <InputWithError label="å°¾æ¬¾é‡‘é¡" type="number" name="balance" value={formData.balance} onChange={e=>handleChange('balance', e.target.value)} placeholder="$0" />
                                </div>
                            )}
                        </section>

{/* åº—å®¶è³‡è¨Š */}
                        <section className="glass-premium p-6 md:p-8 space-y-5 text-sm text-slate-600">
                            <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-4 text-lg">ä¹™æ–¹ï¼ˆåº—å®¶è³‡è¨Šï¼‰</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 bg-slate-50/50 p-5 rounded-2xl border border-slate-100">
                                <p className="flex items-center gap-2"><Icon name="briefcase" size={16} className="text-lion-gold"/><span className="font-bold text-lion-navy">åç¨±ï¼š</span>ä½³æ™Ÿå¯µç‰©ç¾å®¹æ—…é¤¨</p>
                                <p className="flex items-center gap-2"><Icon name="user" size={16} className="text-lion-gold"/><span className="font-bold text-lion-navy">è² è²¬äººï¼š</span>é¡ç¿è«º</p>
                                <p className="flex items-center gap-2"><Icon name="phone" size={16} className="text-lion-gold"/><span className="font-bold text-lion-navy">é›»è©±ï¼š</span>03-360-8693</p>
                                <p className="flex items-center gap-2"><Icon name="file-text" size={16} className="text-lion-gold"/><span className="font-bold text-lion-navy">ç‰¹å¯µï¼š</span>C1130686è™Ÿ</p>
                                <p className="md:col-span-2 flex items-start gap-2"><Icon name="map-pin" size={16} className="text-lion-gold mt-0.5 shrink-0"/><span className="font-bold text-lion-navy">åœ°å€ï¼š</span>æ¡ƒåœ’å¸‚æ¡ƒåœ’å€æ°‘æ—è·¯199-2è™Ÿ</p>
                            </div>
                            <div className="bg-red-50 p-5 rounded-xl text-slate-600 text-xs border border-red-100 space-y-2">
                                <h4 className="font-bold text-red-600 text-sm flex items-center gap-2"><Icon name="ambulance" size={18}/> ä¹™æ–¹æŒ‡å®šé†«ç™‚é™¢æ‰€</h4>
                                <p><span className="font-bold">åç¨±ï¼š</span>å®‰æ¬£å‹•ç‰©é†«é™¢</p>
                                <p><span className="font-bold">é›»è©±ï¼š</span>03-333-6775</p>
                                <p><span className="font-bold">åœ°å€ï¼š</span>æ¡ƒåœ’å¸‚æ¡ƒåœ’å€ä¸­ç¦è¡—60è™Ÿ</p>
                            </div>
                        </section>

{/* æ³•å¾‹èˆ‡ç°½å */}
                        <section className="glass-premium p-6 md:p-8 space-y-5">
                            <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-4 text-lg">æ³•å¾‹æ¢æ¬¾èˆ‡ç°½ç½²</h3>
                            
                            {/* ç¾å®¹æ¢æ¬¾ (æ°¸é é¡¯ç¤º) - ä¿®æ­£ï¼šå¼·åˆ¶ä½¿ç”¨ lion-navy æ·±è—è‰²æ¨£å¼ */}
                            <button onClick={() => setActiveModal('beauty')} className={`w-full flex items-center justify-between p-5 rounded-2xl border-2 transition-all group shadow-sm bg-white ${termsRead.beauty ? 'border-lion-line/50' : 'border-lion-navy hover:bg-lion-navy/5'}`}>
                                <div className="flex items-center gap-4">
                                    <div className={`w-12 h-12 rounded-full flex items-center justify-center transition-colors ${termsRead.beauty ? 'bg-lion-line text-white' : 'bg-lion-navy/10 text-lion-navy'}`}><Icon name={termsRead.beauty ? "check" : "file-text"} size={24}/></div>
                                    <div className="text-left">
                                        <div className="font-bold text-base text-lion-navy">ç¾å®¹æœå‹™å¥‘ç´„æ¢æ¬¾</div>
                                        <div className="text-xs text-slate-400 mt-0.5">{termsRead.beauty ? 'å·²å®Œæˆé–±è®€èˆ‡ç°½ç½²' : 'è«‹é»æ“Šè©³é–±å…§å®¹'}</div>
                                    </div>
                                </div>
                                <div className={`px-3 py-1.5 rounded-lg text-xs font-bold ${termsRead.beauty ? 'bg-lion-line/10 text-lion-line' : 'bg-lion-navy text-white'}`}>{termsRead.beauty ? 'å·²åŒæ„' : 'å¾…é–±è®€'}</div>
                            </button>

                            {/* ä½å®¿æ¢æ¬¾ (åƒ…ä½å®¿é¡¯ç¤º) - æ¨£å¼èˆ‡ç¾å®¹å®Œå…¨ä¸€è‡´ */}
                            {view === 'boarding' && (
                                <button onClick={() => setActiveModal('boarding')} className={`w-full flex items-center justify-between p-5 rounded-2xl border-2 transition-all group shadow-sm bg-white animate-slide-down ${termsRead.boarding ? 'border-lion-line/50' : 'border-lion-navy hover:bg-lion-navy/5'}`}>
                                    <div className="flex items-center gap-4">
                                        <div className={`w-12 h-12 rounded-full flex items-center justify-center transition-colors ${termsRead.boarding ? 'bg-lion-line text-white' : 'bg-lion-navy/10 text-lion-navy'}`}><Icon name={termsRead.boarding ? "check" : "home"} size={24}/></div>
                                        <div className="text-left">
                                            <div className="font-bold text-base text-lion-navy">ä½å®¿/å®‰è¦ªå¥‘ç´„æ¢æ¬¾</div>
                                            <div className="text-xs text-slate-400 mt-0.5">{termsRead.boarding ? 'å·²å®Œæˆé–±è®€èˆ‡ç°½ç½²' : 'è«‹é»æ“Šè©³é–±å…§å®¹'}</div>
                                        </div>
                                    </div>
                                    <div className={`px-3 py-1.5 rounded-lg text-xs font-bold ${termsRead.boarding ? 'bg-lion-line/10 text-lion-line' : 'bg-lion-navy text-white'}`}>{termsRead.boarding ? 'å·²åŒæ„' : 'å¾…é–±è®€'}</div>
                                </button>
                            )}

                            {/* ç°½åå€ */}                            
                            <div className="space-y-4 pt-6 border-t border-slate-200" id="signature">
                                <div className="flex items-center justify-between">
                                    <label className="text-sm font-bold text-lion-navy flex items-center gap-2">
                                        <Icon name="pen-tool" size={18}/> æ•¸ä½ç°½å *
                                    </label>
                                    {realtimeSig && (
                                        <button type="button" onClick={() => setRealtimeSig(null)} className="text-xs font-bold text-red-400 hover:text-red-500 flex items-center gap-1 transition-colors bg-red-50 px-3 py-1.5 rounded-full">
                                            <Icon name="trash-2" size={14}/> é‡ç°½
                                        </button>
                                    )}
                                </div>
                                
                                {realtimeSig ? (
                                    <div className="space-y-3 animate-fade-in">
                                        <div className="bg-white rounded-2xl border-2 border-lion-navy/20 p-6 flex justify-center items-center min-h-[180px] shadow-inner relative overflow-hidden">
                                            <div className="absolute inset-0 opacity-5 bg-[radial-gradient(#1B365D_1px,transparent_1px)] [background-size:16px_16px]"></div>
                                            <img src={realtimeSig} alt="æ‚¨çš„ç°½å" className="max-h-[150px] object-contain relative z-10" />
                                        </div>
                                        <div className="flex items-center justify-end gap-3">
                                            <div className="bg-green-100 text-green-700 px-3 py-1.5 rounded-full text-xs font-bold flex items-center gap-1.5 shadow-sm border border-green-200">
                                                <Icon name="check-circle" size={14}/> å·²ç°½ç½²
                                            </div>
                                            <div className="text-xs text-slate-400 font-bold bg-slate-50 px-3 py-1.5 rounded-full border border-slate-100">
                                                æ™‚é–“ï¼š{new Date().toLocaleString('zh-TW', { hour12: false, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' })}
                                            </div>
                                        </div>
                                    </div>
                                ) : (
                                    <button type="button" onClick={() => { if(allTermsCompleted) setShowFullSig(true); else showToastMsg('è«‹å…ˆå®Œæˆä¸Šæ–¹æ‰€æœ‰å¥‘ç´„æ¢æ¬¾é–±è®€', 'error'); }} 
                                        className={`w-full min-h-[180px] rounded-2xl border-2 border-dashed flex flex-col items-center justify-center gap-3 transition-all group ${allTermsCompleted ? 'border-lion-navy/30 bg-white hover:border-lion-navy hover:bg-lion-gold/5 cursor-pointer' : 'border-slate-200 bg-slate-50 cursor-not-allowed opacity-60'}`}>
                                        <div className={`w-16 h-16 rounded-full flex items-center justify-center transition-all ${allTermsCompleted ? 'bg-lion-navy/5 text-lion-navy group-hover:scale-110 group-hover:bg-lion-gold/20' : 'bg-slate-200 text-slate-400'}`}>
                                            <Icon name={allTermsCompleted ? "pen-tool" : "lock"} size={28}/>
                                        </div>
                                        <span className={`text-sm font-bold ${allTermsCompleted ? 'text-lion-navy' : 'text-slate-400'}`}>{allTermsCompleted ? "é»æ“Šæ­¤è™•é–‹å§‹ç°½å" : "è«‹å…ˆå®Œæˆä¸Šæ–¹æ¢æ¬¾é–±è®€"}</span>
                                        <span className="text-xs text-slate-400">{allTermsCompleted ? "å°‡é–‹å•Ÿå…¨è¢å¹•ç°½åæ¿" : "é–±è®€ä¸¦åŒæ„å¾Œè§£é–"}</span>
                                    </button>
                                )}
                            </div>

                            <button onClick={handleSubmit} disabled={isSubmitting} className="w-full py-5 bg-gradient-to-r from-lion-navy to-[#2A4B7C] text-white rounded-2xl font-bold text-lg shadow-xl shadow-lion-navy/30 active:scale-95 transition-all flex items-center justify-center gap-3 hover:shadow-2xl disabled:opacity-70 disabled:cursor-not-allowed transform hover:-translate-y-1">{isSubmitting ? 'è³‡æ–™æäº¤ä¸­...' : 'ç¢ºèªä¸¦æäº¤é ç´„å–®'} <Icon name="send" size={20}/></button>
                        </section>
                    </main>

{/* Modals - Beauty Terms */}
                    <TermsModal isOpen={activeModal === 'beauty'} onClose={() => setActiveModal(null)} title="ç¾å®¹æœå‹™å¥‘ç´„æ¢æ¬¾" onAgree={() => handleTermAgree('beauty')}>
                        <div className="space-y-4">
                            <p className="font-bold text-lion-navy text-lg border-b pb-2 mb-4">ç¾å®¹æœå‹™ ç°½ç½²è²æ˜èˆ‡æ³•å¾‹ç´„å®š</p>
                            <ol className="list-decimal pl-5 space-y-2 text-justify text-slate-600 text-sm">
                                <li><strong>ç¬¬ä¸€æ¢(å¥‘ç´„ç›®çš„):</strong> æœ¬æœå‹™ç‚ºçŠ¬è²“ç¾å®¹ï¼Œä¸æ¶‰åŠé†«ç™‚è¡Œç‚º;ä¹™æ–¹é ˆç¶­æŒç’°å¢ƒå®‰å…¨ã€é€šé¢¨åŠæ¸…æ½”ã€‚</li>
                                <li><strong>ç¬¬äº”æ¢(å¥åº·å‘ŠçŸ¥):</strong> ç”²æ–¹æ‡‰èª å¯¦å‘ŠçŸ¥å¯µç‰©ç—…å²èˆ‡æ˜¯å¦å…·æœ‰æ”»æ“Šæ€§ã€‚è‹¥å› éš±çå°è‡´æ„å¤–ï¼Œä¹™æ–¹ä¸è² è²¬æå®³è³ å„Ÿè²¬ä»»ï¼›å› éš±çå°è‡´ä¹™æ–¹äººå“¡å‚·äº¡ã€è²¡æç­‰ç›¸é—œæå¤±ï¼Œä¹™æ–¹å°‡å…¨é¡å‘ç”²æ–¹(é£¼ä¸»å¯µç‰©æ‰€æœ‰æ¬Šäºº)æ±‚å„Ÿã€‚</li>
                                <li><strong>ç¬¬ä¹æ¢(é€€è²»è¦å®š):</strong> åŒ…æœˆæœå‹™çµ‚æ­¢æ™‚ï¼Œé æ”¶ç¸½é¡æ‰£é™¤(å·²ä½¿ç”¨æ¬¡æ•¸Xå–®æ¬¡åŸåƒ¹)å¾Œé€€è²»ï¼Œä¹™æ–¹ä¸é¡å¤–æ”¶å–è§£ç´„æ‰‹çºŒè²»ã€‚</li>
                                <li><strong>ç¬¬åäºŒæ¢(é€¾æ™‚æ¥å›):</strong> é£¼ä¸»æ‡‰æ–¼æ´—æ¾¡ç¾å®¹ç•¶æ—¥å°‡å¯µç‰©é ˜å›ï¼Œè‹¥æ–¼ç´„å®šæ™‚é–“å…§æœªé ˜å›ï¼Œä¾ç…§åƒ¹ç›®è¡¨å…¬å‘Šä¹‹å®‰è¦ªè²»é¡å¤–æ”¶è²»ï¼Œæ‰“çƒŠæ™‚ä»æœªæ¥å›ä¾ç…§åƒ¹ç›®è¡¨å…¬å‘Šä¹‹ä½å®¿æˆ¿å‹æ”¶è²»ï¼Œæˆ¿åƒ¹å‰‡ä¾ç…§ç•¶æ—¥ä½å®¿ç‹€æ³å®‰æ’ï¼Œæ»¾å‹•å¼èª¿æ•´ã€‚å¦‚ç¶“é€šçŸ¥ä¸‰æ—¥å…§æœªé ˜å›ï¼Œå°‡ä¾ç…§å‹•ä¿æ³•ç¬¬29æ¢ç¬¬ä¸€æ¬¾é€šçŸ¥ä¸»ç®¡æ©Ÿé—œï¼Œå…¶é¤˜è¡ç”Ÿä¹‹è²»ç”¨å°‡ç”±é£¼ä¸»å…¨é¡æ”¯ä»˜ã€‚</li>
                                <li><strong>ç¬¬åäº”æ¢(å±¥ç´„ä¿éšœ):</strong> é æ”¶è²»ç”¨ç´¯ç©é‡‘é¡æ–°å°å¹£ä¸€è¬å…ƒä»¥ä¸‹ï¼Œä¾æ³•å…æä¾›å±¥ç´„ä¿éšœã€‚</li>
                                <li>å…¶é¤˜ç´°ç¯€å°‡ä¾ç…§è¡Œæ”¿é™¢è¾²å§”æœƒå®šå‹åŒ–å¥‘ç´„ç¯„æœ¬è¾¦ç†ã€‚</li>
                                <li>å› æœ¬å¥‘ç´„æ‰€ç”¢ç”Ÿä¹‹è¨´è¨Ÿï¼Œé›™æ–¹åˆæ„å°‡ä»¥æ¡ƒåœ’åœ°æ–¹æ³•é™¢ç‚ºç¬¬ä¸€å¯©ç®¡è½„æ³•é™¢ã€‚</li>
                            </ol>
                            <div className="mt-6 p-4 bg-slate-50 rounded-xl border border-slate-200 text-xs text-slate-500 space-y-1">
                                <p>â–  ç¶“ç”²ä¹™é›™æ–¹åˆæ„ç´„å®šï¼Œç”±ç”²æ–¹å³æ™‚é–±è®€ç†è§£æœ¬å¥‘ç´„å…§å®¹ä¸¦ç°½ç½²ã€‚</p>
                                <p>â–  ç¶“ç”²æ–¹æœ¬äººå·²ç¢ºèªé è¨ˆæ¥å›æ™‚é–“èˆ‡æœå‹™é‡‘é¡ç„¡èª¤ï¼Œä¸¦åŒæ„ä¸Šè¿°æ¢æ¬¾ã€‚</p>
                            </div>
                        </div>
                    </TermsModal>

                    {/* Modals - Boarding Terms */}
                    <TermsModal isOpen={activeModal === 'boarding'} onClose={() => setActiveModal(null)} title="ä½å®¿/å®‰è¦ªå¥‘ç´„æ¢æ¬¾" onAgree={() => handleTermAgree('boarding')}>
                        <div className="space-y-4">
                            <p className="font-bold text-lion-navy text-lg border-b pb-2 mb-4">ä½å®¿/å®‰è¦ª ç°½ç½²è²æ˜èˆ‡æ³•å¾‹ç´„å®š</p>
                            <p className="text-sm font-bold text-slate-500 mb-2">ç‚ºç¢ºä¿é›™æ–¹æ¬Šåˆ©ï¼Œä»¥ä¸‹å…§å®¹è«‹å‹™å¿…è©³è®€ï¼Œä¸€æ—¦å®Œæˆç°½ç½²å³å…·æœ‰æ³•å¾‹æ•ˆåŠ›</p>
                            <ol className="list-decimal pl-5 space-y-2 text-justify text-slate-600 text-sm">
                                <li>ä½å®¿ä»¥æ™šç‚ºå–®ä½ï¼Œå…¥ä½æ™‚é–“10é»-18é»å‰ï¼Œé€€æˆ¿æ™‚é–“18é»å‰ï¼Œä¸è«–å®‰è¦ª/ç¾å®¹/æ´—æ¾¡/ä½å®¿ï¼Œè¶…éæ‰“çƒŠæ™‚é–“19é»ï¼Œå‰‡éœ€ä½å®¿æ—…é¤¨ä¸€æ™š</li>
                                <li>ä½å®¿æœŸé–“ï¼Œè«‹è‡ªå‚™é£¼æ–™ï¼Œç„¡è‡ªå‚™é£¼æ–™å°‡ä¾ç…§åº—å…§æä¾›ä¹‹é£¼æ–™ç‚ºå„ªå…ˆï¼›è‹¥å› æ›é£Ÿé€ æˆè…¸èƒƒä¸é©ã€è»Ÿä¾¿æˆ–è…¹ç€‰ç­‰ç—‡ç‹€ï¼Œæ—…é¤¨å°‡ä¸è² è²¬è³ å„Ÿ</li>
                                <li>ä½å®¿ç•¶æ—¥é ˆæ–¼æœ¬é¤¨ç¾å®¹éƒ¨å®Œæˆæ´—è­·å¾Œï¼Œæ–¹å¯è¾¦ç†å…¥ä½ï¼›ä½å®¿æ´—æ¾¡è²»ç”¨å¦è¨ˆï¼ŒæœŸé–“è‹¥ç™¼ç¾æœ‰è·³èš¤ã€å£è¨ç­‰å‚³æŸ“æ€§èŸ²èš¤ï¼Œå°‡é¡å¤–æ”¶å–é™¤èŸ²èš¤è²»ç”¨åŠç’°å¢ƒæ¸…æ½”è²»</li>
                                <li>ä½å®¿ç•¶æ—¥é£¼ä¸»éœ€æä¾›èº«åˆ†è­‰ä»¶(ä¾›æœ¬é¤¨å½±å°ç•™å­˜)åŠæ¯›å­©é é˜²é‡æ‰‹å†Šå‚™æŸ¥</li>
                                <li>é£¼ä¸»æ‡‰æ–¼å¥‘ç´„çµ‚æ­¢æ™‚å°‡æ¯›å­©å¸¶å›ï¼Œé€¾æœŸä¸‰æ—¥è¯ç¹«ä¸ä¸Šé£¼ä¸»ï¼Œå°‡æœƒä¾ç…§å‹•ç‰©ä¿è­·æ³•ç¬¬29æ¢ç¬¬ä¸€æ¬¾å°‡å‹•ç‰©äº¤ä»˜å‹•ä¿è™•ä¿ç®¡ï¼›é€¾æœŸæ—¥æœŸä¹‹ä½å®¿è²»ç”¨å°‡ç”±é£¼ä¸»å…¨é¡æ”¯ä»˜</li>
                                <li>ä½å®¿ã€æ´—æ¾¡ã€ç¾å®¹ã€å®‰è¦ªæœŸé–“ï¼Œé£¼ä¸»è‹¥éš±çæ¯›å­©æ›¾æœ‰æ”»æ“Šè¡Œç‚ºï¼Œé€ æˆæœ¬é¤¨äººå“¡æˆ–æ¯›å­©å‚·äº¡æˆ–è²¡ç‰©æ¯€æï¼Œæ‰€æœ‰è¡ç”Ÿè²»ç”¨æœ¬é¤¨æœ‰æ¬Šåˆ©å‘é£¼ä¸»å…¨é¡æ±‚å„Ÿ</li>
                                <li>ä½å®¿ã€æ´—æ¾¡ã€ç¾å®¹ã€å®‰è¦ªæœŸé–“ï¼Œç™¼ç”Ÿå¯µç‰©å å«è²æŒçºŒä¸æ­¢ï¼Œå½±éŸ¿åˆ°åº—å…§ç‡Ÿé‹åŠå‘¨é‚Šé„°å±…å®‰å¯§æ™‚ï¼Œæœ¬é¤¨å°‡æœƒé›»è©±è¯ç¹«é£¼ä¸»åŠç·Šæ€¥é€£çµ¡äººå°‡æ¯›å­©å¸¶å›</li>
                                <li>ä½å®¿æœŸé–“ï¼Œå¦‚ç™¼ç”Ÿèº«é«”ä¸é©ã€æŒçºŒæ€§ä¸‹ç—¢ã€æˆ–å…¶ä»–ç–¾ç—…ï¼Œé ˆç«‹å³é€é†«æ²»ç™‚ï¼Œæœ¬é¤¨å°‡æœƒé›»è©±è¯ç¹«é£¼ä¸»åŠç·Šæ€¥é€£çµ¡äººå°‡æ¯›å­©å¸¶å›ï¼›è‹¥é£¼ä¸»æˆ–ç·Šæ€¥é€£çµ¡äººåŒæ„ç”±æœ¬é¤¨äººå“¡å…ˆå°‡å‹•ç‰©é€é†«æ²»ç™‚ï¼Œè‹¥ç„¡æŒ‡å®šçš„é†«é™¢æˆ–ç—…æ³å±æ€¥å°‡é€å¾€å‘¨é‚Šä¹‹å®‰æ¬£å‹•ç‰©é†«é™¢æ²»ç™‚ï¼Œå…¶æ²»ç™‚ä¹‹ç›¸é—œè²»ç”¨å°‡ç”±é£¼ä¸»å…¨é¡è² æ“”</li>
                                <li>ä½å®¿ã€æ´—æ¾¡ã€ç¾å®¹ã€å®‰è¦ªæœŸé–“ï¼Œé£¼ä¸»é ˆå¦‚å¯¦å‘ŠçŸ¥æ¯›å­©èº«é«”ç‹€æ³ï¼Œè‹¥éš±çç—…æ³ï¼Œé€ æˆå‹•ç‰©ç™¼ç”Ÿæ„å¤–æˆ–æ­»äº¡ï¼Œç¶“é†«é™¢åˆ¤å®šæœ¬é¤¨ç„¡ä»»ä½•ç–å¤±è¡Œç‚ºæˆ–æ¯›å­©æœ¬èº«å…·æœ‰å¿ƒè‡Ÿç—…ã€ç™²ç™‡ã€æ°£å–˜ã€éæ•ã€æ…¢æ€§ç–¾ç—…åŠå„çŠ¬ç¨®æœ¬èº«å¥½ç™¼ä¹‹ç–¾ç—…ç­‰é«˜åº¦å±éšªç–¾ç—…è€…ï¼Œæœ¬é¤¨å°‡ä¸è² è²¬ä»»ä½•è³ å„Ÿç›¸é—œäº‹å®œ</li>
                                <li>ä½å®¿ã€æ´—æ¾¡ã€ç¾å®¹ã€å®‰è¦ªæœŸé–“ï¼Œè‹¥ç™¼ç”Ÿæ¯›å­©èµ°å¤±æˆ–äººç‚ºå› ç´ å°è‡´å—å‚·æˆ–æ­»äº¡ï¼Œæœ¬é¤¨å°‡ä¾æ³•åˆç†è³ å„Ÿï¼Œä¸Šé™30,000å…ƒæ•´ï¼›æ¯›å­©åœ¨æ”¾é¢¨æœŸé–“å› å½¼æ­¤ç©è€å°è‡´çš„å°å‚·ç—•å‰‡ä¸åœ¨æ­¤é™å…§</li>
                                <li>ä½å®¿ã€æ´—æ¾¡ã€ç¾å®¹ã€å®‰è¦ªæœŸé–“ï¼Œåº—å…§ç‰©å“é­åˆ°æ¯›å­©ç ´å£ï¼Œå¦‚æ”å½±æ©Ÿ$3000/å°ã€æˆ¿é–“éš”é–“ã€ç›¸é—œé–‹æ”¾ç‰©å“ç­‰ï¼Œæœ¬é¤¨æœ‰æ¬Šåˆ©å‘é£¼ä¸»å…¨é¡æ±‚å„Ÿ</li>
                                <li>å¯µç‰©å› å¹´è€é«”è™›æˆ–æœ¬èº«æ—¢æœ‰ç–¾ç—…æ­»äº¡ï¼Œé£¼ä¸»æˆ–ç·Šæ€¥è¯çµ¡äººé ˆåœ¨æ¥åˆ°é€šçŸ¥24å°æ™‚å…§é ˜å›å¯µç‰©ï¼Œè¶…éæ™‚é–“æœªé ˜å›å‰‡ç”±æœ¬é¤¨å…¨æ¬Šè™•ç†ï¼Œæ‰€è¡ç”Ÿä¹‹è²»ç”¨ç”±é£¼ä¸»å…¨é¡è² æ“”ã€‚å¦‚å°å¯µç‰©æ­»äº¡åŸå› æœ‰ç–‘æ…®ï¼Œé£¼ä¸»æˆ–ç·Šæ€¥è¯çµ¡äººé ˆåœ¨24å°æ™‚å…§æœƒåŒè‡³æœ¬é¤¨æŒ‡å®šä¹‹å‹•ç‰©é†«é™¢åšé‘‘å®šï¼Œå¦‚ç„¡æ³•åœ¨24å°æ™‚å…§æœƒåŒåšé‘‘å®šï¼Œå‰‡é£¼ä¸»ä¸å¾—æœ‰ç•°è­°ã€‚(ä»¥é€šè¯è¨˜éŒ„ç‚ºæº– )</li>
                                <li>æœ‰æ•£æ­¥éœ€æ±‚ä¹‹å¯µç‰©ï¼Œæ•£æ­¥æ™‚æœ¬é¤¨æœƒå–„ç›¡ä¿è­·ä¹‹è²¬ï¼Œè‹¥å¯µç‰©å› æ™è„«ç‰½ç¹©è€Œå°è‡´é€ƒè·‘ã€å—å‚·ã€æ­»äº¡ç­‰ï¼Œæœ¬é¤¨å°‡ä¸è² è²¬ä»»ä½•è³ å„Ÿç›¸é—œäº‹å®œ</li>
                                <li>å…¶é¤˜ç´°ç¯€å°‡ä¾ç…§è¡Œæ”¿é™¢è¾²å§”æœƒå®šå‹åŒ–å¥‘ç´„ç¯„æœ¬è¾¦ç†ã€‚</li>
                                <li>æœ¬åŒæ„æ›¸ä¸€å¼å…©ä»½ï¼Œç”±é£¼ä¸»èˆ‡æœ¬é¤¨å„åŸ·ä¹™ä»½ã€‚å› æœ¬å¥‘ç´„æ‰€ç”¢ç”Ÿä¹‹è¨´è¨Ÿï¼Œé›™æ–¹åˆæ„å°‡ä»¥æ¡ƒåœ’åœ°æ–¹æ³•é™¢ç‚ºç¬¬ä¸€å¯©ç®¡è½„æ³•é™¢ã€‚</li>
                            </ol>
                            <div className="mt-6 p-4 bg-slate-50 rounded-xl border border-slate-200 text-xs text-slate-500 space-y-1">
                                <p>â–  ç¶“ç”²ä¹™é›™æ–¹åˆæ„ç´„å®šï¼Œç”±ç”²æ–¹å³æ™‚é–±è®€ç†è§£æœ¬å¥‘ç´„å…§å®¹ä¸¦ç°½ç½²ã€‚</p>
                                <p>â–  ç¶“ç”²æ–¹æœ¬äººå·²ç¢ºèªé è¨ˆæ¥å›æ™‚é–“èˆ‡æœå‹™é‡‘é¡ç„¡èª¤ï¼Œä¸¦åŒæ„ä¸Šè¿°æ¢æ¬¾ã€‚</p>
                            </div>
                        </div>
                    </TermsModal>
                    {showFullSig && (
                        <div className="fullscreen-signature animate-fade-in"><div className="p-4 bg-lion-navy text-white flex justify-between items-center shrink-0 shadow-md safe-area-top"><span className="font-bold text-lg flex items-center gap-3"><Icon name="pen-tool" size={24}/> è«‹åœ¨æ­¤ç°½å</span><button onClick={()=>setShowFullSig(false)} className="p-2 hover:bg-white/10 rounded-full transition-colors"><Icon name="x" size={28}/></button></div><div className="flex-1 bg-slate-100 relative p-4">
                                <div className="absolute inset-4 bg-white rounded-3xl shadow-xl border border-slate-200 overflow-hidden">
                                    <canvas ref={fullSigCanvasRef} className="w-full h-full block cursor-crosshair"></canvas>
                                </div>
                                <div className="absolute bottom-6 right-6 text-slate-300 text-xs font-bold pointer-events-none">LION PET SIGNATURE</div>
                            </div><div className="p-6 bg-white border-t flex gap-4 shrink-0 safe-area-bottom"><button onClick={()=>{padInstance.current.clear()}} className="flex-1 py-4 bg-slate-100 font-bold text-slate-500 rounded-xl hover:bg-slate-200 transition-colors text-lg">æ¸…é™¤é‡å¯«</button><button onClick={saveSignature} className="flex-[2] py-4 bg-lion-navy font-bold text-white rounded-xl shadow-lg hover:bg-[#2A4B7C] transition-colors text-lg">ç¢ºèªç°½å</button></div></div>
                    )}

                    {showSuccess && (
                        <div className="fixed inset-0 z-[200] bg-lion-navy/40 backdrop-blur-md flex items-center justify-center p-4"><div className="bg-white rounded-[2.5rem] p-10 max-w-sm w-full text-center space-y-8 animate-slide-down shadow-2xl relative overflow-hidden"><div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-lion-gold to-lion-navy"></div><div className="w-28 h-28 bg-green-50 rounded-full flex items-center justify-center mx-auto text-green-500 mb-4 shadow-inner"><Icon name="check" size={56} strokeWidth={3} /></div><div><h3 className="text-3xl font-serif font-bold text-lion-navy mb-3">é ç´„æˆåŠŸï¼</h3><p className="text-slate-500 text-base leading-relaxed">æ‚¨çš„è³‡æ–™å·²æˆåŠŸé€å‡ºã€‚<br/>æˆ‘å€‘æœƒç›¡å¿«é€éé›»è©±æˆ– LINE èˆ‡æ‚¨ç¢ºèªã€‚</p></div><button onClick={() => window.location.reload()} className="w-full py-5 bg-lion-navy text-white rounded-2xl font-bold shadow-xl hover:bg-[#2A4B7C] transition-colors text-lg">è¿”å›é¦–é </button></div></div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
