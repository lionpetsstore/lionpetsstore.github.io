<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>èŠæ©å¯µç‰©æ²™é¾ç²¾å“æ—…é¤¨ | Lion Pet Beauty Casa</title>
    
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/react-datepicker@4.25.0/dist/react-datepicker.min.css">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        lion: {
                            navy: '#1B365D',      /* æ·±æµ·è»è— */
                            gold: '#C5A065',      /* é¦™æª³é‡‘ */
                            light: '#F5F5F7',     /* æ·ºç°ç™½ */
                            line: '#06C755',      /* LINE ç¶ è‰² */
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans TC"', 'sans-serif'],
                        serif: ['"Playfair Display"', 'serif']
                    },
                    animation: {
                        'scroll': 'scroll 25s linear infinite',
                        'fade-in': 'fadeIn 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards',
                        'slide-up': 'slideUp 0.4s cubic-bezier(0.22, 1, 0.36, 1) forwards',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 10s infinite ease-in-out',
                        'float-delayed': 'float 12s infinite ease-in-out reverse',
                    },
                    keyframes: {
                        scroll: {
                            '0%': { transform: 'translateX(0)' },
                            '100%': { transform: 'translateX(-50%)' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(100%)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translate(0, 0)' },
                            '50%': { transform: 'translate(0, 20px)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap');

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #F5F5F7;
            color: #1B365D;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* å‡ç´šç‰ˆç»ç’ƒæ“¬æ…‹ */
        .glass-premium {
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 8px 32px 0 rgba(27, 54, 93, 0.05);
            border-radius: 1.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .glass-premium::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 100%;
            background: linear-gradient(180deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 100%);
            pointer-events: none; z-index: 0;
        }

        /* èƒŒæ™¯å…‰çƒ */
        .bg-orb {
            position: fixed; border-radius: 50%; filter: blur(80px); z-index: -1; opacity: 0.6;
        }

        .cute-input { 
            background: rgba(255, 255, 255, 0.8); border: 1px solid #E2E8F0; transition: all 0.3s ease;
            color: #1B365D; font-size: 1rem; backdrop-filter: blur(4px);
        }
        .cute-input:focus { 
            background: #ffffff; border-color: #C5A065; outline: none; box-shadow: 0 0 0 4px rgba(197, 160, 101, 0.15);
        }

        .radio-card {
            transition: all 0.2s ease; border: 1px solid #E2E8F0; background: rgba(255, 255, 255, 0.6);
        }
        .radio-card:active { transform: scale(0.98); }
        .radio-card.selected {
            background-color: #F8FAFC; border-color: #1B365D; border-width: 2px;
            box-shadow: 0 4px 12px rgba(27, 54, 93, 0.1);
        }
        .radio-card.danger.selected { background-color: #FEF2F2; border-color: #EF4444; }

        .fullscreen-signature { position: fixed; inset: 0; z-index: 100; background: white; display: flex; flex-direction: column; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div class="bg-orb w-96 h-96 bg-blue-100 top-0 left-0 animate-float"></div>
    <div class="bg-orb w-80 h-80 bg-orange-100 bottom-0 right-0 animate-float-delayed"></div>
    <div class="bg-orb w-64 h-64 bg-purple-50 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-pulse-slow"></div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        const mockSubmit = async (data) => {
            return new Promise((resolve) => setTimeout(() => resolve({ status: 'success' }), 1500));
        };

        // --- Icons (é˜²ç•¶æ©Ÿç‰ˆ) ---
        const Icon = ({ name, size = 20, className = "" }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (iconRef.current) {
                    iconRef.current.innerHTML = '';
                    const i = document.createElement('i');
                    i.setAttribute('data-lucide', name);
                    i.style.width = '100%';
                    i.style.height = '100%';
                    iconRef.current.appendChild(i);
                    lucide.createIcons({ root: iconRef.current });
                }
            }, [name]);
            return <span ref={iconRef} style={{ width: size, height: size, display: 'inline-flex' }} className={className} />;
        };

        const Marquee = () => {
            const images = [
                'line_oa_chat_260121_230912_group_0.jpg', 'line_oa_chat_260121_230912_group_1.jpg',
                'line_oa_chat_260121_230912_group_2.jpg', 'line_oa_chat_260121_230908_group_0.jpg',
                'line_oa_chat_260121_230908_group_1.jpg', 'line_oa_chat_260121_230908_group_2.jpg'
            ];
            return (
                <div className="w-full overflow-hidden relative h-40 md:h-56 rounded-3xl mb-8 glass-premium border-0 shadow-lg group">
                    <div className="absolute inset-0 z-10 bg-lion-navy/5 pointer-events-none group-hover:bg-transparent transition-colors"></div>
                    <div className="flex w-[200%] animate-scroll h-full">
                        {[...images, ...images].map((src, idx) => (
                            <div key={idx} className="w-1/3 h-full flex-shrink-0 px-1">
                                <img src={src} className="w-full h-full object-cover rounded-xl" alt="Environment" />
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const Toast = ({ message, type = 'error' }) => (
            <div className={`fixed top-24 left-1/2 -translate-x-1/2 z-[200] px-6 py-3 rounded-full shadow-2xl text-white font-bold text-sm tracking-wide flex items-center gap-2 ${type === 'error' ? 'bg-red-500/90' : 'bg-lion-line/90'} backdrop-blur-md animate-fade-in border border-white/20`}>
                <Icon name={type==='error'?'alert-circle':'check-circle'} size={18}/>
                {message}
            </div>
        );

        const InputWithError = ({ label, name, type = 'text', value, onChange, placeholder, error, className = '', ...props }) => (
            <div className="space-y-1.5 w-full relative z-10">
                {label && <label className="text-xs font-bold text-slate-500 ml-1">{label}</label>}
                <input 
                    name={name} type={type} value={value} onChange={onChange} 
                    className={`w-full cute-input rounded-xl px-4 py-3 font-bold text-lion-navy placeholder-slate-300 ${error ? 'border-red-500 bg-red-50/50' : ''} ${className}`} 
                    placeholder={placeholder} {...props}
                />
            </div>
        );

        // --- Terms Modal (å¼·åˆ¶é–±è®€æ¢æ¬¾å½ˆçª—) ---
        const TermsModal = ({ isOpen, onClose, title, children, onAgree }) => {
            const contentRef = useRef(null);
            const [canAgree, setCanAgree] = useState(false);

            useEffect(() => {
                if (isOpen) {
                    setCanAgree(false);
                    document.body.style.overflow = 'hidden';
                    setTimeout(() => {
                        if (contentRef.current && contentRef.current.scrollHeight <= contentRef.current.clientHeight + 10) {
                            setCanAgree(true);
                        }
                    }, 300);
                } else {
                    document.body.style.overflow = '';
                }
            }, [isOpen]);

            const handleScroll = (e) => {
                const { scrollTop, scrollHeight, clientHeight } = e.target;
                if (scrollHeight - scrollTop - clientHeight < 50) setCanAgree(true);
            };

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 z-[150] bg-lion-navy/40 backdrop-blur-sm flex items-end md:items-center justify-center p-0 md:p-4 animate-fade-in">
                    <div className="bg-white w-full md:max-w-lg md:rounded-3xl rounded-t-3xl shadow-2xl flex flex-col max-h-[85vh] md:max-h-[80vh] animate-slide-up">
                        <div className="px-6 py-4 border-b border-slate-100 flex justify-between items-center shrink-0">
                            <h3 className="text-lg font-serif font-bold text-lion-navy">{title}</h3>
                            <button onClick={onClose} className="p-2 bg-slate-50 rounded-full hover:bg-slate-100 transition-colors">
                                <Icon name="x" size={20} className="text-slate-400" />
                            </button>
                        </div>
                        <div ref={contentRef} onScroll={handleScroll} className="flex-1 overflow-y-auto p-6 text-sm text-slate-600 leading-relaxed space-y-4">
                            {children}
                            <div className="h-10"></div>
                        </div>
                        <div className="p-5 border-t border-slate-100 bg-white md:rounded-b-3xl shrink-0 safe-area-bottom">
                            {!canAgree && (
                                <div className="text-center text-xs font-bold text-lion-gold mb-3 animate-pulse">ğŸ‘‡ è«‹æ»‘å‹•è‡³æœ€åº•éƒ¨ä»¥åŒæ„æ¢æ¬¾</div>
                            )}
                            <button onClick={() => { if(canAgree) { onAgree && onAgree(); onClose(); } }} disabled={!canAgree}
                                className={`w-full py-4 rounded-xl font-bold text-base flex items-center justify-center gap-2 transition-all ${canAgree ? 'bg-lion-navy text-white shadow-lg active:scale-95 hover:bg-[#2A4B7C]' : 'bg-slate-100 text-slate-400 cursor-not-allowed'}`}>
                                <Icon name={canAgree ? "check-circle" : "lock"} size={20} />
                                {canAgree ? "æˆ‘å·²è©³é–±ä¸¦åŒæ„" : "è«‹é–±è®€å®Œç•¢"}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            const [view, setView] = useState('home');
            const [toast, setToast] = useState(null);
            
            // è¡¨å–®è³‡æ–™
            const [formData, setFormData] = useState({
                // é€šç”¨
                email: '', owner_name: '', phone: '', owner_id: '', address: '', 
                emergency_name: '', emergency_phone: '',
                pet_name: '', breed: '', sex: '', age_type: 'adult', age: '', age_months: '', weight: '', fix: '',
                chip_status: '', chip_id: '', preferred_clinic: '',
                legal_agree: false, signature: null,
                // ç¾å®¹å°ˆç”¨
                dog_traits: [], temperament: '', service_type: '',
                // ä½å®¿å°ˆç”¨
                checkin_date: '', checkout_date: '',
                is_barking: '', has_boarding_exp: '', is_food_aggressive: '', use_peepad: '',
                vaccine_status: '', deworming_status: '', cage_training: '', 
                // ç—…å²
                medical_history: 'ç„¡', medical_tags: [], medical_other: '',
                food_allergy: '', personality_note: '', special_note: '',
                // é«˜é½¡é¢¨éšªåŒæ„
                high_risk_agree: false
            });            
            const [errors, setErrors] = useState({});
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [showSuccess, setShowSuccess] = useState(false);
            
            // UI ç‹€æ…‹æ§åˆ¶
            const [showFullSig, setShowFullSig] = useState(false);
            const [realtimeSig, setRealtimeSig] = useState(null);
            const fullSigCanvasRef = useRef(null);
            const padInstance = useRef(null);
            const [lineConfirmed, setLineConfirmed] = useState(false);

            // Modal & æ¢æ¬¾ç‹€æ…‹
            const [activeModal, setActiveModal] = useState(null);
            const [termsRead, setTermsRead] = useState({ basic: false, highRisk: false });

            // é‚è¼¯åˆ¤æ–·
            const isHighRisk = formData.age_type === 'adult' && parseInt(formData.age) >= 8;
            const allTermsCompleted = useMemo(() => {
                if (!termsRead.basic) return false;
                if (isHighRisk && !termsRead.highRisk) return false;
                return true;
            }, [termsRead, isHighRisk]);

            const handleTermAgree = (type) => {
                setTermsRead(prev => ({ ...prev, [type]: true }));
                if (type === 'highRisk') setFormData(prev => ({ ...prev, high_risk_agree: true }));
            };

            useEffect(() => {
                const handleHashChange = () => {
                    const hash = window.location.hash.slice(1);
                    if (hash === 'grooming' || hash === 'boarding' || hash === 'home') {
                        setView(hash);
                        window.scrollTo(0, 0);
                    } else {
                        setView('home');
                    }
                };
                window.addEventListener('hashchange', handleHashChange);
                handleHashChange();
                return () => window.removeEventListener('hashchange', handleHashChange);
            }, []);

            const updateHash = (newView) => window.location.hash = newView;
            
            const showToastMsg = (msg, type='error') => {
                setToast({ message: msg, type });
                setTimeout(() => setToast(null), 3000);
            };

            const handleChange = (field, value) => {
                setFormData(prev => ({ ...prev, [field]: value }));
                if (errors[field]) setErrors(prev => ({ ...prev, [field]: null }));
            };

            const toggleArray = (field, value) => {
                setFormData(prev => {
                    const arr = prev[field] || [];
                    return { ...prev, [field]: arr.includes(value) ? arr.filter(i=>i!==value) : [...arr, value] };
                });
            };

            const validate = () => {
                const newErrors = {};
                const commonRequired = ['email', 'owner_name', 'phone', 'address', 'emergency_name', 'emergency_phone', 'pet_name', 'breed', 'weight', 'sex', 'fix', 'chip_status'];
                commonRequired.forEach(f => { if (!formData[f]) newErrors[f] = true; });

                if (view === 'grooming') {
                    if (!formData.temperament) newErrors.temperament = true;
                    if (formData.dog_traits.length === 0) newErrors.dog_traits = true;
                    if (!formData.service_type) newErrors.service_type = true;
                } else if (view === 'boarding') {
                    if (!formData.checkin_date) newErrors.checkin_date = true;
                    if (!formData.checkout_date) newErrors.checkout_date = true;
                    if (!formData.cage_training) newErrors.cage_training = true;
                    if (!formData.is_barking) newErrors.is_barking = true;
                    if (!formData.has_boarding_exp) newErrors.has_boarding_exp = true;
                    if (!formData.is_food_aggressive) newErrors.is_food_aggressive = true;
                    if (!formData.use_peepad) newErrors.use_peepad = true;
                    if (!formData.vaccine_status) newErrors.vaccine_status = true;
                    if (!formData.deworming_status) newErrors.deworming_status = true;
                    if (!formData.medical_history) newErrors.medical_history = true;
                }

                if (formData.chip_status === 'æœ‰æ™¶ç‰‡' && !formData.chip_id) newErrors.chip_id = true;
                if (formData.age_type === 'adult' && parseInt(formData.age) >= 8 && !formData.high_risk_agree) { 
                    showToastMsg('8æ­²ä»¥ä¸Šæ¯›å­©è«‹å‹¾é¸é«˜é½¡é¢¨éšªæ¢æ¬¾', 'error'); 
                    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
                    return false; 
                }

                if (!lineConfirmed) { showToastMsg('è«‹å…ˆå®Œæˆ LINE ç¢ºèª'); return false; }
                if (!allTermsCompleted) { showToastMsg('è«‹å…ˆè©³é–±ä¸Šæ–¹æ¢æ¬¾æŒ‰éˆ•ä¸¦åŒæ„'); return false; }
                if (!formData.legal_agree) { showToastMsg('è«‹å‹¾é¸åŒæ„æ‰€æœ‰å¥‘ç´„å…§å®¹'); return false; }
                if (!realtimeSig) { showToastMsg('è«‹å®Œæˆæ•¸ä½ç°½å'); return false; }

                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            };

            const handleSubmit = async () => {
                if (!validate()) { showToastMsg('è«‹æª¢æŸ¥ç´…æ¡†æ¬„ä½'); window.scrollTo({ top: 200, behavior: 'smooth' }); return; }
                setIsSubmitting(true);
                await mockSubmit();
                setIsSubmitting(false);
                setShowSuccess(true);
            };

// æ–°å¢ï¼šç”¨ä¾†è¨˜éŒ„ç•«å¸ƒå°ºå¯¸çš„ Ref
            const canvasSizeRef = useRef({ width: 0, height: 0 });

            // ä¿®æ­£ç°½åæ¿é‚è¼¯ (è§£æ±ºæ‰‹æ©Ÿç„¡æ³•ç°½åå•é¡Œ)
            useEffect(() => {
                let timer;
                
                // é˜²æ­¢æ‰‹æ©Ÿåœ¨ç°½åæ™‚æ»¾å‹•ç•«é¢
                const preventTouchMove = (e) => {
                    if (showFullSig) e.preventDefault();
                };

                // åˆå§‹åŒ–ç•«å¸ƒ (é—œéµä¿®å¾©ï¼šè™•ç†é«˜è§£æåº¦è¢å¹•)
                const initCanvas = () => {
                    const canvas = fullSigCanvasRef.current;
                    if (!canvas) return;
                    
                    // å–å¾—çˆ¶å®¹å™¨çš„å¤§å°
                    const container = canvas.parentElement;
                    const rect = container.getBoundingClientRect();
                    const displayWidth = rect.width;
                    const displayHeight = rect.height;
                    
                    canvasSizeRef.current = { width: displayWidth, height: displayHeight };
                    
                    // è™•ç†è¦–ç¶²è†œè¢å¹• (Retina Display) ç¸®æ”¾æ¯”ä¾‹
                    const ratio = Math.max(window.devicePixelRatio || 1, 1);
                    canvas.width = displayWidth * ratio;
                    canvas.height = displayHeight * ratio;
                    
                    // è¨­å®šé¡¯ç¤ºå¤§å°
                    canvas.style.width = displayWidth + 'px';
                    canvas.style.height = displayHeight + 'px';
                    
                    const ctx = canvas.getContext("2d");
                    ctx.scale(ratio, ratio);
                    
                    // ç¢ºä¿èƒŒæ™¯æ˜¯ç™½è‰² (é¿å…å­˜æª”è®Šé»‘è‰²èƒŒæ™¯)
                    ctx.fillStyle = "rgb(255, 255, 255)";
                    ctx.fillRect(0, 0, displayWidth, displayHeight);
                    
                    // é‡ç½®ä¸¦åˆå§‹åŒ– SignaturePad
                    if (padInstance.current) {
                        padInstance.current.off();
                    }
                    
                    // ç­†è§¸è¨­å®š
                    padInstance.current = new SignaturePad(canvas, { 
                        penColor: "rgb(27, 54, 93)", // æ”¹ç”¨èŠæ©çš„æ·±è—è‰²ç­†è·¡
                        backgroundColor: "rgb(255, 255, 255)", 
                        minWidth: 1.5,
                        maxWidth: 4.0,
                        throttle: 16, 
                        minDistance: 3, 
                        velocityFilterWeight: 0.7,
                    });
                };

                if (showFullSig) {
                    // é–å®šèƒŒæ™¯æ²å‹•
                    document.body.style.overflow = 'hidden';
                    document.addEventListener('touchmove', preventTouchMove, { passive: false });
                    
                    // å»¶é²ä¸€é»é»åˆå§‹åŒ–ï¼Œç¢ºä¿å½ˆçª—å‹•ç•«çµæŸï¼Œå¯¬åº¦æ­£ç¢º
                    timer = setTimeout(initCanvas, 150);
                }
                
                return () => { 
                    if (timer) clearTimeout(timer);
                    if (padInstance.current) padInstance.current.off(); 
                    
                    // è§£é™¤é–å®š
                    document.body.style.overflow = '';
                    document.removeEventListener('touchmove', preventTouchMove);
                };
            }, [showFullSig]);

            const saveSignature = () => {
                if (padInstance.current && !padInstance.current.isEmpty()) {
                    setRealtimeSig(padInstance.current.toDataURL());
                    setShowFullSig(false);
                } else {
                    showToastMsg('è«‹å…ˆç°½å');
                }
            };

// --- Home View (Classic) ---
            if (view === 'home') {
                return (
                    <div className="min-h-screen relative flex flex-col font-sans">
                        {/* ç§»é™¤ä½”ç©ºé–“çš„ç©º navï¼Œç›´æ¥è¨­å®š main çš„é ‚éƒ¨é–“è· */}
                        <main className="flex-1 px-6 pb-10 max-w-lg mx-auto w-full pt-12 md:pt-20">
                            <div className="text-center mb-10 animate-fade-in relative z-10">
                                <img src="logo.png" className="w-72 md:w-96 h-auto mx-auto object-contain drop-shadow-lg mb-6 hover:scale-105 transition-transform duration-500" />
                                <p className="text-lion-gold text-[10px] font-bold tracking-[0.4em] uppercase">Luxury Pet Salon</p>
                            </div>
                            <Marquee />
                            <div className="space-y-5 animate-fade-in" style={{animationDelay:'0.1s'}}>
                                <div onClick={() => updateHash('grooming')} className="glass-premium p-6 flex items-center gap-6 cursor-pointer hover:shadow-lg hover:border-lion-gold/30 transition-all border border-white group">
                                    <div className="w-16 h-16 bg-white rounded-2xl flex items-center justify-center text-lion-navy shadow-sm border border-slate-50 group-hover:bg-lion-navy group-hover:text-white transition-colors relative z-10"><Icon name="scissors" size={28} /></div>
                                    <div className="flex-1 relative z-10">
                                        <h3 className="text-xl font-serif font-bold text-lion-navy group-hover:text-lion-gold transition-colors">ç²¾ç·»ç¾å®¹</h3>
                                        <p className="text-slate-500 text-xs mt-1">å°ˆæ¥­é€ å‹ä¿®å‰ª Â· æ·±å±¤çš®æ¯›è­·ç†</p>
                                    </div>
                                    <div className="w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center group-hover:bg-lion-gold group-hover:text-white transition-colors relative z-10"><Icon name="chevron-right" size={16} /></div>
                                </div>
                                <div onClick={() => updateHash('boarding')} className="glass-premium p-6 flex items-center gap-6 cursor-pointer hover:shadow-lg hover:border-lion-gold/30 transition-all border border-white group">
                                    <div className="w-16 h-16 bg-[#F9F5EC] rounded-2xl flex items-center justify-center text-lion-gold shadow-sm border border-slate-50 group-hover:bg-lion-gold group-hover:text-white transition-colors relative z-10"><Icon name="home" size={28} /></div>
                                    <div className="flex-1 relative z-10">
                                        <h3 className="text-xl font-serif font-bold text-lion-navy group-hover:text-lion-gold transition-colors">ç²¾å“ä½å®¿</h3>
                                        <p className="text-slate-500 text-xs mt-1">å¯¬æ•ç¨ç«‹ç©ºé–“ Â· 24H æº«æ¿•åº¦ç›£æ§</p>
                                    </div>
                                    <div className="w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center group-hover:bg-lion-gold group-hover:text-white transition-colors relative z-10"><Icon name="chevron-right" size={16} /></div>
                                </div>
                            </div>
                            <div className="mt-8 grid grid-cols-3 gap-4 animate-fade-in" style={{animationDelay:'0.2s'}}>
                                <a href="tel:033608693" className="glass-premium p-4 flex flex-col items-center justify-center gap-2 hover:-translate-y-1 transition-transform border border-white group">
                                    <Icon name="phone" className="text-slate-400 group-hover:text-lion-navy transition-colors" /><span className="text-[10px] font-bold text-lion-navy">æ’¥æ‰“é›»è©±</span>
                                </a>
                                <a href="https://www.facebook.com/lionbeautycasa/?locale=zh_TW" target="_blank" className="glass-premium p-4 flex flex-col items-center justify-center gap-2 hover:-translate-y-1 transition-transform border border-white group">
                                    <Icon name="facebook" className="text-[#1877F2]" /><span className="text-[10px] font-bold text-lion-navy">Facebook</span>
                                </a>
                                <a href="https://lin.ee/jS3JP5z" className="glass-premium p-4 flex flex-col items-center justify-center gap-2 hover:-translate-y-1 transition-transform border border-white group">
                                    <img src="https://lionpetsstore.github.io/line.png" className="w-5 h-5 object-contain" /><span className="text-[10px] font-bold text-lion-navy">åŠ å¥½å‹</span>
                                </a>
                            </div>
                            <div className="mt-8 text-center animate-fade-in" style={{animationDelay:'0.3s'}}>
                                <a href="https://maps.app.goo.gl/Kc4xdPe2KowoLcUR9" target="_blank" className="inline-flex items-center gap-2 text-lion-navy font-bold text-sm bg-white/80 backdrop-blur px-5 py-3 rounded-full shadow-sm border border-slate-100 hover:scale-105 hover:shadow-md hover:border-lion-gold/50 transition-all">
                                    <Icon name="map-pin" size={18} className="text-lion-gold"/> æ¡ƒåœ’å¸‚æ¡ƒåœ’å€æ°‘æ—è·¯199-2è™Ÿ
                                </a>
                            </div>
                        </main>
                        <footer className="text-center py-8 text-[10px] text-slate-400 font-bold relative z-10"><p>ç‰¹å¯µæ¥­å­—ç¬¬ C1130686 è™Ÿ</p><p className="mt-1">Â© 2026 Lion Pet Beauty Casa.</p></footer>
                    </div>
                );
            }

            return (
                <div className="min-h-screen pb-40">
                    {toast && <Toast message={toast.message} type={toast.type} />}
                    <nav className="fixed top-0 w-full z-40 bg-white/80 backdrop-blur-md border-b border-slate-200/50 shadow-sm transition-all">
                        <div className="px-6 py-4 flex justify-between items-center max-w-5xl mx-auto">
                            <div className="flex items-center gap-4 cursor-pointer group" onClick={() => updateHash('home')}>
                                <img src="logo.png" className="w-16 h-16 md:w-20 md:h-20 object-contain group-hover:scale-105 transition-transform" /> 
                                <div className="flex flex-col"><span className="font-serif font-bold text-lion-navy text-lg md:text-xl tracking-wide">LION PET</span><span className="text-[10px] md:text-xs text-lion-gold tracking-widest uppercase font-bold">Beauty Casa</span></div>
                            </div>
                            <button onClick={() => updateHash('home')} className="text-xs font-bold text-slate-500 bg-slate-100/80 px-4 py-2 rounded-full flex items-center gap-2 hover:bg-slate-200 transition-colors"><Icon name="arrow-left" size={14}/> <span className="hidden md:inline">è¿”å›é¦–é </span></button>
                        </div>
                    </nav>

                    <main className="pt-28 px-4 md:px-8 max-w-4xl mx-auto space-y-8">
                        <div className="text-center space-y-2 mb-8 relative z-10">
                            <h2 className="text-2xl md:text-3xl font-serif font-bold text-lion-navy drop-shadow-sm">{view === 'boarding' ? 'ä½å®¿é ç´„èˆ‡å¥åº·å•å·' : 'ç¾å®¹æœå‹™é ç´„å–®'}</h2>
                            <p className="text-sm text-slate-500 font-medium">è«‹å¡«å¯«ä»¥ä¸‹è³‡è¨Šä»¥å®Œæˆé ç´„</p>
                        </div>

                        <div className="glass-premium p-6 md:p-8 border-l-4 border-lion-line shadow-sm">
                            <div className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6">
                                <div>
                                    <h3 className="font-bold text-lion-navy text-xl flex items-center gap-2"><img src="https://lionpetsstore.github.io/line.png" className="w-7 h-7"/> åŠ å…¥å®˜æ–¹ LINE</h3>
                                    <p className="text-sm text-slate-500 font-bold mt-1 ml-9">ID: @149veapq</p>
                                </div>
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <a href="https://lin.ee/jS3JP5z" className="bg-slate-50/50 rounded-2xl p-4 text-center border hover:bg-white transition-colors group">
                                    <div className="w-8 h-8 bg-lion-line text-white rounded-full flex items-center justify-center text-sm font-bold mx-auto mb-2 shadow-sm group-hover:scale-110 transition-transform">1</div><div className="text-base font-bold text-lion-line">é»æ“ŠåŠ å…¥å¥½å‹</div>
                                </a>
                                <div className="bg-red-50/50 rounded-2xl p-4 text-center border border-red-100">
                                    <div className="w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center text-sm font-bold mx-auto mb-2 shadow-sm animate-pulse-slow">2</div><div className="text-base font-bold text-red-600">å‹™å¿…ã€Œå‚³é€è²¼åœ–ã€</div>
                                </div>
                            </div>
                            <button onClick={() => setLineConfirmed(!lineConfirmed)} className={`w-full py-4 rounded-xl font-bold text-sm border transition-all ${lineConfirmed ? 'bg-lion-line text-white border-lion-line shadow-md' : 'bg-white text-slate-400 border-slate-300 hover:bg-slate-50'}`}>{lineConfirmed ? "âœ… æˆ‘å·²å®Œæˆä¸Šè¿°å…©æ­¥é©Ÿ" : "ç¢ºèªï¼šæˆ‘å·²å®Œæˆä¸Šè¿°å…©æ­¥é©Ÿ"}</button>
                        </div>

                        {view === 'boarding' && (
                            <section className="glass-premium p-6 md:p-8 space-y-5">
                                <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-3 flex items-center gap-2 text-lg"><Icon name="home" size={20}/> ä½å®¿ç’°å¢ƒä»‹ç´¹</h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div className="bg-[#FFF8E1]/60 p-5 rounded-2xl border border-[#FFE082]/30 backdrop-blur-sm"><h4 className="font-bold text-lion-navy mb-2 flex items-center gap-2 text-base"><Icon name="cat" size={18}/> ä¸€æ¨“ï¼šè²“å’ªä½å®¿</h4><p className="text-sm text-slate-600 leading-relaxed text-justify">è²“å’ªå°ˆå±¬æ¨“å±¤ï¼Œæ¯æ—¥æ¶ˆæ¯’ã€æ†æº«èˆ’é©ã€‚ç¨ç«‹ç©ºèª¿å¾ªç’°ï¼Œè®“è²“è²“å€‘èƒ½è‡ªåœ¨æ›¬å¤ªé™½ã€çª©åœ¨æŸ”è»Ÿçš„æ¯¯å­è£¡ç™¼å‘†ã€‚</p></div>
                                    <div className="bg-[#E3F2FD]/60 p-5 rounded-2xl border border-[#90CAF9]/30 backdrop-blur-sm"><h4 className="font-bold text-lion-navy mb-2 flex items-center gap-2 text-base"><Icon name="dog" size={18}/> äºŒæ¨“ï¼šç‹—ç‹—ä½å®¿</h4><p className="text-sm text-slate-600 leading-relaxed text-justify">æ¯æ—¥é™ªç©ã€å®šæ™‚æ•£æ­¥ã€‚å¤œé–“ä¿å§†å·¡æˆ¿ï¼Œä¸åªæ˜¯ã€Œå¯„æ”¾ã€ï¼Œè€Œæ˜¯è¢«ç…§é¡§ã€è¢«ç–¼æ„›ã€è¢«é™ªä¼´ã€‚</p></div>
                                </div>
                            </section>
                        )}

                        <section className="glass-premium p-6 md:p-8 space-y-6">
                            <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-3 flex items-center gap-2 text-lg"><Icon name="user" size={20}/> é£¼ä¸»åŸºæœ¬è³‡æ–™</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <InputWithError label="é›»å­éƒµä»¶ *" name="email" type="email" value={formData.email} onChange={e=>handleChange('email', e.target.value)} error={errors.email} placeholder="å¯„é€å¥‘ç´„å‰¯æœ¬ç”¨" />
                                <InputWithError label="ä¸»äººå§“å *" name="owner_name" value={formData.owner_name} onChange={e=>handleChange('owner_name', e.target.value)} error={errors.owner_name} />
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="flex gap-3 items-end"><div className="flex-1"><InputWithError label="é€£çµ¡é›»è©± *" name="phone" type="tel" value={formData.phone} onChange={e=>handleChange('phone', e.target.value)} error={errors.phone} /></div><button className="bg-lion-navy text-white h-[50px] px-4 rounded-xl font-bold text-xs shadow-md hover:bg-blue-900 transition-colors whitespace-nowrap">èˆŠå®¢æŸ¥è©¢</button></div>
                                <InputWithError label={view==='boarding' ? "èº«åˆ†è­‰å­—è™Ÿ (å…¥ä½è«‹æ”œå¸¶æ­£æœ¬æ ¸å°) *" : "èº«åˆ†è­‰å­—è™Ÿ *"} name="owner_id" value={formData.owner_id} onChange={e=>handleChange('owner_id', e.target.value)} />
                            </div>
                            <InputWithError label="é€šè¨Šåœ°å€ *" name="address" value={formData.address} onChange={e=>handleChange('address', e.target.value)} error={errors.address} />
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-red-50/50 rounded-2xl border border-red-100">
                                <InputWithError label="ç·Šæ€¥è¯çµ¡äºº *" name="emergency_name" value={formData.emergency_name} onChange={e=>handleChange('emergency_name', e.target.value)} error={errors.emergency_name} className="bg-white/80" />
                                <InputWithError label="ç·Šæ€¥é›»è©± *" name="emergency_phone" value={formData.emergency_phone} onChange={e=>handleChange('emergency_phone', e.target.value)} error={errors.emergency_phone} className="bg-white/80" />
                            </div>
                        </section>

                        <section className="glass-premium p-6 md:p-8 space-y-6">
                            <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-3 flex items-center gap-2 text-lg"><Icon name="paw-print" size={20}/> å¯µç‰©è©³ç´°è³‡æ–™</h3>
                            {view === 'boarding' && (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 bg-lion-gold/10 p-5 rounded-2xl border border-lion-gold/20 mb-6">
                                    <div className="space-y-1"><label className="text-xs font-bold text-lion-navy">å…¥ä½æ—¥æœŸ *</label><input type="date" className="w-full cute-input rounded-xl px-4 py-3 text-sm" value={formData.checkin_date} onChange={e=>handleChange('checkin_date', e.target.value)} /></div>
                                    <div className="space-y-1"><label className="text-xs font-bold text-lion-navy">é€€æˆ¿æ—¥æœŸ *</label><input type="date" className="w-full cute-input rounded-xl px-4 py-3 text-sm" value={formData.checkout_date} onChange={e=>handleChange('checkout_date', e.target.value)} /></div>
                                </div>
                            )}
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <InputWithError label="å¯µç‰©åå­— *" name="pet_name" value={formData.pet_name} onChange={e=>handleChange('pet_name', e.target.value)} error={errors.pet_name} />
                                <InputWithError label="å“ç¨® *" name="breed" value={formData.breed} onChange={e=>handleChange('breed', e.target.value)} error={errors.breed} />
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <InputWithError label="é«”é‡ (kg) *" name="weight" type="number" value={formData.weight} onChange={e=>handleChange('weight', e.target.value)} error={errors.weight} />
                                <div className="space-y-2">
                                    <label className="text-xs font-bold text-slate-500">å¹´é½¡ *</label>
                                    <div className="flex gap-2 mb-2">
                                        <button onClick={()=>handleChange('age_type','adult')} className={`flex-1 py-2 rounded-xl border text-xs font-bold transition-all ${formData.age_type==='adult' ? 'bg-lion-navy text-white' : 'bg-white/50 text-slate-500 border-slate-200'}`}>æ»¿ä¸€æ­²</button>
                                        <button onClick={()=>handleChange('age_type','baby')} className={`flex-1 py-2 rounded-xl border text-xs font-bold transition-all ${formData.age_type==='baby' ? 'bg-lion-navy text-white' : 'bg-white/50 text-slate-500 border-slate-200'}`}>æœªæ»¿ä¸€æ­²</button>
                                    </div>
                                    {formData.age_type==='adult' ? (
                                        <input type="number" className="w-full cute-input rounded-xl px-4 py-3" placeholder="è«‹è¼¸å…¥æ­²æ•¸" value={formData.age} onChange={e=>handleChange('age', e.target.value)} />
                                    ) : (
                                        <select className="w-full cute-input rounded-xl px-4 py-3" value={formData.age_months} onChange={e=>handleChange('age_months', e.target.value)}><option value="">é¸æ“‡æœˆé½¡</option>{[...Array(11)].map((_,i)=><option key={i} value={i+1}>{i+1} å€‹æœˆ</option>)}</select>
                                    )}
                                </div>
                            </div>
                            <div className="grid grid-cols-2 gap-6">
                                <div className="space-y-2"><label className="text-xs font-bold text-slate-500">æ€§åˆ¥ *</label><div className="flex gap-2">{['å…¬','æ¯'].map(v=>(<button key={v} onClick={()=>handleChange('sex',v)} className={`flex-1 py-3 rounded-xl border text-sm font-bold transition-all ${formData.sex===v?'bg-lion-navy text-white border-lion-navy':'bg-white/50 text-slate-500 border-slate-300'}`}>{v}</button>))}</div>{errors.sex && <div className="text-red-500 text-[10px]">å¿…é¸</div>}</div>
                                <div className="space-y-2"><label className="text-xs font-bold text-slate-500">çµç´® *</label><div className="flex gap-2">{['æ˜¯','å¦'].map(v=>(<button key={v} onClick={()=>handleChange('fix',v)} className={`flex-1 py-3 rounded-xl border text-sm font-bold transition-all ${formData.fix===v?'bg-lion-navy text-white border-lion-navy':'bg-white/50 text-slate-500 border-slate-300'}`}>{v}</button>))}</div>{errors.fix && <div className="text-red-500 text-[10px]">å¿…é¸</div>}</div>
                            </div>
                            <div className="space-y-2">
                                <label className="text-xs font-bold text-slate-500">ç¤¾äº¤ç‹€æ³ (å¯è¤‡é¸) *</label>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-3">{['æœ‰æ”»æ“Šæ€§','ç„¡æ”»æ“Šæ€§','å¯èˆ‡ç‹—æœ‹å‹å€‘ä¸€èµ·ç©è€','ä¸èƒ½èˆ‡ç‹—æœ‹å‹å€‘ä¸€èµ·ç©è€'].map(v=>(<div key={v} onClick={()=>toggleArray('dog_traits',v)} className={`radio-card p-4 rounded-xl cursor-pointer flex items-center justify-between ${formData.dog_traits.includes(v) ? 'selected' : ''}`}><span className="text-sm font-bold text-lion-navy">{v}</span><div className={`w-5 h-5 rounded-full border flex items-center justify-center radio-circle ${formData.dog_traits.includes(v) ? 'border-lion-navy bg-lion-navy' : 'border-slate-300'}`}></div></div>))}</div>{errors.dog_traits && <div className="text-red-500 text-[10px]">è«‹è‡³å°‘é¸æ“‡ä¸€é …</div>}
                            </div>
                            <div className="space-y-2">
                                <label className="text-xs font-bold text-slate-500">å¯µç‰©ç¾å®¹æ€§æƒ…èˆ‡æ”»æ“Šæ€§è©•ä¼° *</label>
                                <div className="space-y-3">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                        {[
                                            {val: 'å¤©ä½¿å¯¶å¯¶', title: 'å¤©ä½¿å¯¶å¯¶', desc: 'å€‹æ€§æº«å’Œï¼Œç„¡ä»»ä½•æ”»æ“Šç´€éŒ„ï¼Œä¹Ÿä¸æ€•ç”Ÿã€‚'},
                                            {val: 'æœ‰é»ç·Šå¼µ', title: 'æœ‰é»ç·Šå¼µ', desc: 'è†½å°æ€•ç”Ÿï¼Œå¯èƒ½æœƒä½å¼æˆ–é–ƒèº²ï¼Œä½†æœªæ›¾å’¬äººã€‚'}
                                        ].map(item => (<div key={item.val} onClick={()=>handleChange('temperament', item.val)} className={`radio-card p-4 rounded-xl cursor-pointer flex items-start gap-3 h-full ${formData.temperament===item.val ? 'selected' : ''}`}><div className={`w-5 h-5 rounded-full border mt-0.5 shrink-0 flex items-center justify-center radio-circle ${formData.temperament===item.val ? 'border-lion-navy bg-lion-navy' : 'border-slate-300'}`}></div><div><div className="font-bold text-sm text-lion-navy">{item.title}</div><div className="text-xs text-slate-500 mt-1 leading-relaxed">{item.desc}</div></div></div>))}
                                    </div>
                                    <div onClick={()=>handleChange('temperament', 'æ°åŒ—åŒ—/è­·ä¸»')} className={`radio-card danger p-4 rounded-xl cursor-pointer flex items-start gap-3 ${formData.temperament==='æ°åŒ—åŒ—/è­·ä¸»' ? 'selected' : ''}`}><div className={`w-5 h-5 rounded-full border mt-0.5 shrink-0 flex items-center justify-center radio-circle ${formData.temperament==='æ°åŒ—åŒ—/è­·ä¸»' ? 'border-red-500 bg-red-500' : 'border-slate-300'}`}></div><div><div className="font-bold text-sm text-red-600 flex items-center gap-1">æ°åŒ—åŒ—/è­·ä¸» <Icon name="alert-triangle" size={14}/></div><div className="text-xs text-slate-500 mt-1 leading-relaxed">å°æ–¼ç‰¹å®šéƒ¨ä½æ•æ„Ÿï¼Œæˆ–çœ‹åˆ°é™Œç”Ÿäººæœƒå…‡ï¼Œæ›¾æœ‰æ”»æ“Šç´€éŒ„ã€‚</div><div className="text-xs font-bold text-red-500 mt-2 bg-red-50 px-3 py-1.5 rounded inline-block border border-red-100">âš ï¸ è«‹å‹™å¿…å‘ŠçŸ¥ï¼Œè®“æˆ‘å€‘åšå¥½é˜²è­·</div></div></div>
                                </div>
                                {errors.temperament && <div className="text-red-500 text-[10px]">æ­¤æ¬„ä½å¿…å¡«</div>}
                            </div>
                            <div className="space-y-2">
                                <label className="text-xs font-bold text-slate-500">æ™¶ç‰‡ *</label>
                                <div className="flex flex-wrap gap-2">{['æœ‰æ™¶ç‰‡','æœ‰æ™¶ç‰‡(è™Ÿç¢¼ä¸è©³)','ç„¡æ™¶ç‰‡'].map(v=>(<button key={v} onClick={()=>handleChange('chip_status',v)} className={`px-4 py-3 rounded-xl border text-sm font-bold transition-all flex-1 md:flex-none ${formData.chip_status===v ? 'bg-lion-navy text-white border-lion-navy' : 'bg-white/50 text-slate-500 border-slate-300'}`}>{v}</button>))}</div>
                                {formData.chip_status === 'æœ‰æ™¶ç‰‡' && <div className="animate-slide-down overflow-hidden"><input type="text" className="w-full cute-input rounded-xl px-4 py-3 mt-2 font-bold" placeholder="è«‹è¼¸å…¥æ™¶ç‰‡è™Ÿç¢¼" value={formData.chip_id} onChange={e => handleChange('chip_id', e.target.value)} />{errors.chip_id && <div className="text-red-500 text-[10px] mt-1">è«‹è¼¸å…¥è™Ÿç¢¼</div>}</div>}
                            </div>
                            <div className="space-y-3 pt-4 border-t border-slate-100">
                                <label className="text-xs font-bold text-slate-500">éå¾€ç—…å² (å¯è¤‡é¸) *</label>
                                <div className="flex gap-2">
                                    <button onClick={()=>handleChange('medical_history', 'æœ‰')} className={`flex-1 py-3 rounded-xl border font-bold transition-all flex items-center justify-center gap-2 ${formData.medical_history==='æœ‰' ? 'bg-lion-navy text-white border-lion-navy shadow-md' : 'bg-white/50 text-slate-400 border-slate-200 hover:border-lion-gold'}`}><Icon name="check-circle" size={18} className="mb-0.5"/> æœ‰</button>
                                    <button onClick={()=>{handleChange('medical_history', 'ç„¡'); handleChange('medical_tags', []);}} className={`flex-1 py-3 rounded-xl border font-bold transition-all ${formData.medical_history==='ç„¡' ? 'bg-slate-100 text-slate-600 border-slate-200' : 'bg-white/50 text-slate-400 border-slate-200 hover:border-slate-300'}`}>ç„¡</button>
                                </div>
                                {formData.medical_history === 'æœ‰' && <div className="animate-slide-down space-y-3 bg-slate-50/50 p-5 rounded-2xl border border-slate-200"><div className="flex flex-wrap gap-2">{['å¿ƒè‡Ÿç—…','æ°£å–˜','æ°£ç®¡å¡Œé™·','ç™½å…§éšœ','ç™²ç™‡','å¿ƒçµ²èŸ²','è‰¾åˆ©å¸Œé«”','è…¹è†œç‚','è…¹ç©æ°´','æ‰‹è¡“å¤–å‚·æœªç™’åˆ','é«–é—œç¯€å•é¡Œ','éª¨æŠ˜','è…¸ç‚','è¡€ä¾¿','è¡€å°¿','æ‡·å­•','å‚³è¨ºæ€§ç–¾ç—…','+ å…¶ä»–'].map(tag => (<button key={tag} onClick={()=>toggleArray('medical_tags', tag)} className={`px-3 py-1.5 rounded-lg text-xs font-bold border transition-all ${formData.medical_tags.includes(tag) ? (tag === '+ å…¶ä»–' ? 'bg-lion-gold text-white border-lion-gold' : 'bg-lion-navy text-white border-lion-navy') : 'bg-white text-slate-500 border-slate-200 hover:border-lion-navy/30'}`}>{tag}</button>))}</div>{formData.medical_tags.includes('+ å…¶ä»–') && <textarea className="w-full cute-input rounded-xl px-4 py-3 h-20 text-sm animate-fade-in focus:border-lion-gold" placeholder="è«‹è©³ç´°èªªæ˜å…¶ä»–ç—…å²..." value={formData.medical_other} onChange={e=>handleChange('medical_other', e.target.value)}></textarea>}</div>}
                            </div>
                            <div className="space-y-2">
                                <label className="text-xs font-bold text-slate-500">æŒ‡å®šå°±é†«è¨ºç™‚æ©Ÿæ§‹</label>
                                <InputWithError name="preferred_clinic" value={formData.preferred_clinic} onChange={e=>handleChange('preferred_clinic', e.target.value)} placeholder="è‹¥æœªå¡«å¯«ï¼Œå‰‡é€å¾€ç‰¹ç´„é†«é™¢" />
                                <div className="p-3 bg-slate-50/50 rounded-xl text-xs text-slate-500 flex items-start gap-2"><Icon name="info" size={16} className="text-lion-navy shrink-0 mt-0.5"/><span><span className="font-bold text-lion-navy">ç‰¹ç´„é†«é™¢ï¼š</span> [å¾…ç¢ºèª]</span></div>
                            </div>
                        </section>

                        {view === 'boarding' && (
                            <section className="glass-premium p-6 md:p-8 space-y-6">
                                <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-3 flex items-center gap-2 text-lg"><Icon name="list-checks" size={20}/> ä½å®¿è¡Œç‚ºèˆ‡å¥åº·å•å·</h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                                    {[
                                        { key: 'is_barking', label: 'å®¹æ˜“å å«å—', opts: ['æœƒ','ä¸æœƒ'] },
                                        { key: 'has_boarding_exp', label: 'æœ‰ä½å®¿ç¶“é©—å—', opts: ['æœ‰','æ²’æœ‰'] },
                                        { key: 'is_food_aggressive', label: 'æœƒè­·é£Ÿå—', opts: ['æœƒ','ä¸æœƒ'] },
                                        { key: 'use_peepad', label: 'æœƒç”¨å°¿å¸ƒå¢Šå—', opts: ['æœƒ','ä¸æœƒ'] },
                                        { key: 'vaccine_status', label: 'å®šæœŸæ–½æ‰“ç–«è‹—', opts: ['æœ‰','æ²’æœ‰'] },
                                        { key: 'deworming_status', label: 'å®šæœŸé©…èŸ²', opts: ['æœ‰','ç„¡'] },
                                    ].map(item => (<div key={item.key} className="flex flex-col gap-2"><label className="text-xs font-bold text-slate-500">{item.label} *</label><div className="flex gap-2">{item.opts.map(opt => (<button key={opt} onClick={()=>handleChange(item.key, opt)} className={`flex-1 py-3 rounded-xl border text-sm font-bold transition-all ${formData[item.key]===opt ? 'bg-lion-navy text-white border-lion-navy' : 'bg-white/50 text-slate-500 border-slate-300'}`}>{opt}</button>))}</div>{errors[item.key] && <div className="text-red-500 text-[10px]">å¿…é¸</div>}</div>))}
                                </div>
                                <div className="space-y-3 pt-2">
                                    <label className="text-xs font-bold text-slate-500">ç± å…§è¨“ç·´ç‹€æ³ *</label>
                                    <div className="space-y-2">
                                        {['æœ‰ï¼Œå¹³å¸¸åœ¨å®¶éƒ½æœ‰åœ¨åœæ¬„å…§æˆ–ç± å­ç¡è¦º','æœ‰ï¼Œä»¥å‰æœ‰è¨“ç·´éä½†æ—¥å¸¸æ²’æœ‰ç¶­æŒ','æœ‰ï¼Œä½†ä¸ç¢ºèªç¾åœ¨èƒ½ä¸èƒ½é©æ‡‰','æ²’æœ‰ï¼Œä½†ä¹‹å‰åœ¨å¤–ä½å®¿åœ¨æˆ¿é–“å¯ä»¥é©æ‡‰å¾—å¾ˆå¥½','å¾ä¾†æ²’æœ‰'].map(opt => (<div key={opt} onClick={()=>handleChange('cage_training', opt)} className={`radio-card p-3 rounded-xl cursor-pointer flex items-center gap-3 ${formData.cage_training===opt ? 'selected' : ''}`}><div className={`w-4 h-4 rounded-full border shrink-0 radio-circle ${formData.cage_training===opt ? 'border-lion-navy bg-lion-navy' : 'border-slate-300'}`}></div><span className="text-xs font-bold text-lion-navy">{opt}</span></div>))}
                                    </div>
                                    {errors.cage_training && <div className="text-red-500 text-[10px]">å¿…é¸</div>}
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 pt-2">
                                    <div className="space-y-1"><label className="text-xs font-bold text-lion-navy">é£²é£Ÿéæ•</label><textarea className="w-full cute-input rounded-xl px-4 py-3 h-24 text-sm" placeholder="å°ä»€éº¼éæ•å—? (å¦‚é›è‚‰/ç‰›è‚‰)" onChange={e=>handleChange('food_allergy', e.target.value)}></textarea></div>
                                    <div className="space-y-1"><label className="text-xs font-bold text-lion-navy">å€‹æ€§å‚™è¨»</label><textarea className="w-full cute-input rounded-xl px-4 py-3 h-24 text-sm" placeholder="å€‹æ€§å¦‚ä½•? æœ‰åˆ†é›¢ç„¦æ…®å—?" onChange={e=>handleChange('personality_note', e.target.value)}></textarea></div>
                                    <div className="space-y-1 md:col-span-2"><label className="text-xs font-bold text-lion-navy">ç‰¹åˆ¥æ³¨æ„äº‹é …</label><textarea className="w-full cute-input rounded-xl px-4 py-3 h-24 text-sm" placeholder="æœ‰éœ€è¦ç‰¹åˆ¥æ³¨æ„çš„å—? è¶Šè©³ç´°è¶Šå¥½" onChange={e=>handleChange('special_note', e.target.value)}></textarea></div>
                                </div>
                            </section>
                        )}

                        {view === 'grooming' && (
                            <section className="glass-premium p-6 md:p-8 space-y-5">
                                <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-3 flex items-center gap-2 text-lg"><Icon name="bath" size={20}/> æœ¬æ¬¡æœå‹™å…§å®¹</h3>
                                <div className="w-full">
                                    <div className="grid grid-cols-2 gap-4 md:gap-6 mb-6">
                                        <div onClick={()=>handleChange('service_type','ç²¾ç·»æ´—æ¾¡')} className={`w-full aspect-[1.1/1] md:aspect-[2.5/1] rounded-2xl cursor-pointer flex flex-col items-center justify-center text-center gap-2 md:gap-3 transition-all border-2 relative overflow-hidden group px-2 ${formData.service_type==='ç²¾ç·»æ´—æ¾¡'?'border-lion-navy bg-[#F8FAFC] shadow-lg shadow-blue-900/5':'border-slate-100 bg-white/60 hover:border-lion-gold'}`}><div className={`w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mb-1 transition-colors ${formData.service_type==='ç²¾ç·»æ´—æ¾¡'?'bg-lion-navy text-white':'bg-slate-50 text-lion-navy group-hover:bg-lion-gold/10'}`}><Icon name="droplets" size={24} strokeWidth={2} className="md:w-8 md:h-8"/></div><div><h4 className={`text-base md:text-xl font-serif font-bold mb-1 ${formData.service_type==='ç²¾ç·»æ´—æ¾¡'?'text-lion-navy':'text-slate-600'}`}>ç²¾ç·»æ´—æ¾¡</h4><p className="text-[10px] md:text-sm text-slate-400 leading-tight px-1">æ´—æ¯›æ½¤çµ²Â·å‰ªæŒ‡ç”²Â·æ¸…è€³æœµÂ·è‚›é–€è…ºÂ·ä¿®é›œæ¯›Â·çœ¼éƒ¨æ•´ç†</p></div></div>
                                        <div onClick={()=>handleChange('service_type','ç²¾ç·»ç¾å®¹')} className={`w-full aspect-[1.1/1] md:aspect-[2.5/1] rounded-2xl cursor-pointer flex flex-col items-center justify-center text-center gap-2 md:gap-3 transition-all border-2 relative overflow-hidden group px-2 ${formData.service_type==='ç²¾ç·»ç¾å®¹'?'border-lion-navy bg-[#F8FAFC] shadow-lg shadow-blue-900/5':'border-slate-100 bg-white/60 hover:border-lion-gold'}`}><div className={`w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mb-1 transition-colors ${formData.service_type==='ç²¾ç·»ç¾å®¹'?'bg-lion-navy text-white':'bg-slate-50 text-lion-navy group-hover:bg-lion-gold/10'}`}><Icon name="scissors" size={24} strokeWidth={2} className="md:w-8 md:h-8"/></div><div><h4 className={`text-base md:text-xl font-serif font-bold mb-1 ${formData.service_type==='ç²¾ç·»ç¾å®¹'?'text-lion-navy':'text-slate-600'}`}>ç²¾ç·»ç¾å®¹</h4><p className="text-[10px] md:text-sm text-slate-400 leading-tight px-1">åŸºç¤æ´—æ¾¡ + å…¨èº«é€ å‹ä¿®å‰ª</p></div></div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4 md:gap-6">{['å±€éƒ¨ä¿®å‰ª','å¯µç‰©å®‰è¦ª'].map(v=>(<button key={v} onClick={()=>handleChange('service_type',v)} className={`w-full py-4 rounded-xl border font-bold text-sm md:text-base transition-all ${formData.service_type===v ? 'bg-lion-navy text-white border-lion-navy shadow-md' : 'bg-white/50 text-slate-400 border-slate-200 hover:border-lion-gold'}`}>{v}</button>))}</div>{errors.service_type && <div className="text-red-500 text-[10px] text-center mt-2">è«‹é¸æ“‡æœå‹™é …ç›®</div>}
                                </div>
                                <div className="bg-orange-50/80 backdrop-blur-sm p-4 rounded-xl text-xs md:text-sm text-orange-800 font-bold leading-relaxed border border-orange-100 flex gap-2 items-start mt-2"><Icon name="alert-triangle" size={18} className="shrink-0 mt-0.5"/><span>éœ€æ–¼é€šçŸ¥å®Œæˆå¾Œä¸€å°æ™‚å…§æ¥å›ï¼Œè¶…éæ™‚é–“å°‡æ”¶å– <span className="underline">$[å¾…ç¢ºèª]/æ™‚</span> å®‰è¦ªè²»ç”¨</span></div>
                            </section>
                        )}

                        <section className="glass-premium p-6 md:p-8 space-y-4">
                            <h3 className="font-bold text-lion-navy border-b border-slate-200 pb-3 flex items-center gap-2 text-lg"><Icon name="message-circle" size={20}/> å…¶ä»–éœ€æ±‚æˆ–å‚™è¨»</h3>
                            <textarea className="w-full cute-input rounded-xl px-4 py-3 h-24 text-sm" placeholder="è«‹åœ¨æ­¤å¡«å¯«å…¶ä»–éœ€æ±‚æˆ–å‚™è¨»äº‹é …..." value={formData.additional_notes} onChange={e=>handleChange('additional_notes', e.target.value)}></textarea>
                        </section>

                        <section className="glass-premium p-6 md:p-8 space-y-8">
                            <div className="bg-slate-50/50 p-6 rounded-2xl text-xs md:text-sm text-slate-500 space-y-3 border border-slate-200"><h4 className="font-bold text-lion-navy text-base mb-3 border-b border-slate-200 pb-2">ä¹™æ–¹ï¼ˆåº—å®¶è³‡è¨Šï¼‰</h4><div className="grid grid-cols-1 md:grid-cols-2 gap-2"><p><span className="font-bold text-lion-navy">åº—å®¶åç¨±ï¼š</span>èŠæ©å¯µç‰©æ²™é¾ç²¾å“æ—…é¤¨</p><p><span className="font-bold text-lion-navy">è² è²¬äººï¼š</span>[å¾…ç¢ºèª]</p><p><span className="font-bold text-lion-navy">è¯çµ¡é›»è©±ï¼š</span>03-360-8693</p><p><span className="font-bold text-lion-navy">ç‡Ÿæ¥­æ™‚é–“ï¼š</span>10:00-19:00</p><p className="md:col-span-2"><span className="font-bold text-lion-navy">ç‡Ÿæ¥­åœ°å€ï¼š</span>æ¡ƒåœ’å¸‚æ¡ƒåœ’å€æ°‘æ—è·¯199-2è™Ÿ</p><p><span className="font-bold text-lion-navy">ç‰¹å¯µæ¥­å­—è™Ÿï¼š</span>C1130686è™Ÿ</p><p><span className="font-bold text-lion-navy">ç·Šæ€¥å°±é†«ï¼š</span>[å¾…ç¢ºèª]</p></div></div>

                            {/* æ³•å¾‹æ¢æ¬¾èˆ‡æ•¸ä½ç°½ç½² (ä¿®æ­£ç‰ˆ) */}
                            <div className="space-y-6">
                                <h3 className="font-bold text-lion-navy border-b pb-3 flex items-center gap-2 text-lg"><Icon name="file-text" size={20}/> æ³•å¾‹æ¢æ¬¾èˆ‡æ•¸ä½ç°½ç½²</h3>
                                <div className="bg-slate-50 rounded-3xl p-6 space-y-4 border border-slate-200">
                                    <button onClick={() => setActiveModal('basic')} className={`w-full flex items-center justify-between p-5 rounded-2xl border-2 transition-all group shadow-sm bg-white ${termsRead.basic ? 'border-lion-line/50' : 'border-lion-gold hover:border-lion-navy'}`}><div className="flex items-center gap-4"><div className={`w-12 h-12 rounded-full flex items-center justify-center transition-colors ${termsRead.basic ? 'bg-lion-line text-white' : 'bg-lion-gold/10 text-lion-gold'}`}><Icon name={termsRead.basic ? "check" : "file-text"} size={24}/></div><div className="text-left"><div className="font-bold text-base text-lion-navy">{view === 'boarding' ? 'å¯„å®¿å¥‘ç´„æ¢æ¬¾' : 'ç¾å®¹æœå‹™å¥‘ç´„æ¢æ¬¾'}</div><div className="text-xs text-slate-400 mt-0.5">{termsRead.basic ? 'å·²å®Œæˆé–±è®€èˆ‡ç°½ç½²' : 'è«‹é»æ“Šè©³é–±å…§å®¹'}</div></div></div><div className={`px-3 py-1.5 rounded-lg text-xs font-bold ${termsRead.basic ? 'bg-lion-line/10 text-lion-line' : 'bg-lion-gold text-white'}`}>{termsRead.basic ? 'å·²åŒæ„' : 'å¾…é–±è®€'}</div></button>
                                    {isHighRisk && (<button onClick={() => setActiveModal('highRisk')} className={`w-full flex items-center justify-between p-5 rounded-2xl border-2 transition-all group shadow-sm bg-white animate-slide-down ${termsRead.highRisk ? 'border-lion-line/50' : 'border-red-400 hover:border-red-600'}`}><div className="flex items-center gap-4"><div className={`w-12 h-12 rounded-full flex items-center justify-center transition-colors ${termsRead.highRisk ? 'bg-lion-line text-white' : 'bg-red-100 text-red-500'}`}><Icon name={termsRead.highRisk ? "check" : "alert-triangle"} size={24}/></div><div className="text-left"><div className={`font-bold text-base ${termsRead.highRisk ? 'text-lion-navy' : 'text-red-600'}`}>é«˜é½¡å¯µç‰©é¢¨éšªå‘ŠçŸ¥</div><div className="text-xs text-slate-400 mt-0.5">{termsRead.highRisk ? 'å·²å®Œæˆé–±è®€èˆ‡ç°½ç½²' : 'æª¢æ¸¬åˆ° 8 æ­²ä»¥ä¸Šï¼Œå‹™å¿…è©³é–±'}</div></div></div><div className={`px-3 py-1.5 rounded-lg text-xs font-bold ${termsRead.highRisk ? 'bg-lion-line/10 text-lion-line' : 'bg-red-500 text-white'}`}>{termsRead.highRisk ? 'å·²åŒæ„' : 'å¾…é–±è®€'}</div></button>)}
                                    <div onClick={() => { if (!allTermsCompleted) { showToastMsg("è«‹å…ˆé»æ“Šä¸Šæ–¹æŒ‰éˆ•ï¼Œè©³é–±ä¸¦åŒæ„æ‰€æœ‰æ¢æ¬¾", "error"); } }} className={`transition-all duration-300 ${!allTermsCompleted ? 'opacity-50' : ''}`}><label className={`flex items-center gap-4 p-5 rounded-2xl border-2 cursor-pointer transition-all bg-white ${!allTermsCompleted ? 'border-slate-200 pointer-events-none' : 'border-lion-navy/20 hover:border-lion-navy shadow-sm'}`}><div className="relative flex items-center"><input type="checkbox" checked={formData.legal_agree} onChange={e=> { if (allTermsCompleted) handleChange('legal_agree', e.target.checked); }} disabled={!allTermsCompleted} className="w-6 h-6 accent-lion-navy cursor-pointer" /></div><span className={`text-sm font-bold ${allTermsCompleted ? 'text-lion-navy' : 'text-slate-400'}`}>{allTermsCompleted ? "æˆ‘å·²è©³é–±ä¸¦åŒæ„ä¸Šè¿°æ‰€æœ‰å¥‘ç´„å…§å®¹" : "è«‹å…ˆå®Œæˆä¸Šæ–¹æ¢æ¬¾é–±è®€ä»¥è§£é–æ­¤é¸é …"}</span>{!allTermsCompleted && <Icon name="lock" size={16} className="text-slate-400 ml-auto" />}</label></div>
                                </div>
                            </div>

<div className="space-y-4 pt-6 border-t border-slate-200" id="signature">
                                <div className="flex items-center justify-between">
                                    <label className="text-sm font-bold text-lion-navy flex items-center gap-2">
                                        <Icon name="pen-tool" size={18}/> æ•¸ä½ç°½å *
                                    </label>
                                    {realtimeSig && (
                                        <button type="button" onClick={() => setRealtimeSig(null)} className="text-xs font-bold text-red-400 hover:text-red-500 flex items-center gap-1 transition-colors bg-red-50 px-3 py-1.5 rounded-full">
                                            <Icon name="trash-2" size={14}/> é‡ç°½
                                        </button>
                                    )}
                                </div>
                                
                                {realtimeSig ? (
                                    <div className="space-y-3 animate-fade-in">
                                        <div className="bg-white rounded-2xl border-2 border-lion-navy/20 p-6 flex justify-center items-center min-h-[180px] shadow-inner relative overflow-hidden">
                                            {/* èƒŒæ™¯ç´‹è·¯ */}
                                            <div className="absolute inset-0 opacity-5 bg-[radial-gradient(#1B365D_1px,transparent_1px)] [background-size:16px_16px]"></div>
                                            <img src={realtimeSig} alt="æ‚¨çš„ç°½å" className="max-h-[150px] object-contain relative z-10" />
                                        </div>
                                        <div className="flex items-center justify-end gap-3">
                                            <div className="bg-green-100 text-green-700 px-3 py-1.5 rounded-full text-xs font-bold flex items-center gap-1.5 shadow-sm border border-green-200">
                                                <Icon name="check-circle" size={14}/> å·²ç°½ç½²
                                            </div>
                                            <div className="text-xs text-slate-400 font-bold bg-slate-50 px-3 py-1.5 rounded-full border border-slate-100">
                                                æ™‚é–“ï¼š{new Date().toLocaleString('zh-TW', { hour12: false, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' })}
                                            </div>
                                        </div>
                                    </div>
                                ) : (
                                    <button type="button" onClick={() => setShowFullSig(true)} 
                                        className={`w-full min-h-[180px] rounded-2xl border-2 border-dashed flex flex-col items-center justify-center gap-3 transition-all group ${errors.signature ? 'border-red-500 bg-red-50/50 shake-error' : 'border-lion-navy/30 bg-white hover:border-lion-navy hover:bg-lion-gold/5'}`}>
                                        <div className="w-16 h-16 rounded-full bg-lion-navy/5 flex items-center justify-center text-lion-navy group-hover:scale-110 group-hover:bg-lion-gold/20 transition-all">
                                            <Icon name="pen-tool" size={28}/>
                                        </div>
                                        <span className="text-sm font-bold text-lion-navy">é»æ“Šæ­¤è™•é–‹å§‹ç°½å</span>
                                        <span className="text-xs text-slate-400">å°‡é–‹å•Ÿå…¨è¢å¹•ç°½åæ¿</span>
                                    </button>
                                )}
                            </div>

                            <button onClick={handleSubmit} disabled={isSubmitting} className="w-full py-5 bg-lion-navy text-white rounded-2xl font-bold text-lg shadow-xl shadow-blue-900/20 active:scale-95 transition-all flex items-center justify-center gap-3 hover:bg-[#2A4B7C] relative overflow-hidden group"><span className="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></span>{isSubmitting ? 'æäº¤ä¸­...' : 'ç¢ºèªä¸¦æäº¤é ç´„å–®'} <Icon name="send" size={20}/></button>
                        </section>
                    </main>

                    <TermsModal isOpen={activeModal === 'basic'} onClose={() => setActiveModal(null)} title={view === 'boarding' ? 'å¯„å®¿å¥‘ç´„æ¢æ¬¾' : 'ç¾å®¹æœå‹™å¥‘ç´„æ¢æ¬¾'} onAgree={() => handleTermAgree('basic')}>
                        <div className="space-y-4">
                            <p className="font-bold text-lion-navy text-lg">æ­¡è¿ä¾†åˆ°èŠæ©å¯µç‰©æ²™é¾ï¼</p><p>ç‚ºç¢ºä¿æ¯›å­©å®‰å…¨èˆ‡é›™æ–¹æ¬Šç›Šï¼Œè«‹è©³é–±ä»¥ä¸‹å…§å®¹ï¼š</p>
                            <div className="space-y-3 p-4 bg-slate-50 rounded-xl border border-slate-100">
                                <p><span className="font-bold text-lion-navy">1. å¥åº·è²æ˜ï¼š</span>é£¼ä¸»ä¿è­‰å¯µç‰©ç„¡å‚³æŸ“æ€§ç–¾ç—…ï¼Œè‹¥æœ‰éš±çéœ€è² æ“”ç›¸é—œè²¬ä»»ã€‚</p>
                                <p><span className="font-bold text-lion-navy">2. ç·Šæ€¥é†«ç™‚ï¼š</span>ç™¼ç”Ÿä¸é©å°‡é€å¾€ç‰¹ç´„å‹•ç‰©é†«é™¢ï¼Œè²»ç”¨ç”±é£¼ä¸»è² æ“”ã€‚</p>
                                {view === 'boarding' ? (<><p><span className="font-bold text-lion-navy">3. ä½å®¿è¦ç¯„ï¼š</span>å…¥ä½æ™‚é–“ 10:00-19:00ï¼Œé€¾æ™‚å°‡æ”¶å–è¶…æ™‚è²»ç”¨ã€‚</p><p><span className="font-bold text-lion-navy">4. è²¬ä»»æ­¸å±¬ï¼š</span>è‹¥å› ä¸å¯æŠ—åŠ›æˆ–å¯µç‰©è‡ªèº«å®¿ç–¾å¼•ç™¼ä¹‹æ„å¤–ï¼Œæœ¬åº—ä¸è² è³ å„Ÿè²¬ä»»ã€‚</p></>) : (<><p><span className="font-bold text-lion-navy">3. æ”»æ“Šæ€§å‘ŠçŸ¥ï¼š</span>è‹¥æœ‰æ”»æ“Šæ€§è«‹å‹™å¿…å‘ŠçŸ¥ï¼Œè‹¥å› æ­¤é€ æˆç¾å®¹å¸«å—å‚·ï¼Œéœ€è² æ“”é†«ç™‚è²»ç”¨ã€‚</p><p><span className="font-bold text-lion-navy">4. æ¥å›æ™‚é–“ï¼š</span>ç¾å®¹å®Œæˆå¾Œè«‹æ–¼é€šçŸ¥å¾Œä¸€å°æ™‚å…§æ¥å›ã€‚</p></>)}
                            </div>
                            <div className="space-y-2 text-slate-400 text-xs"><p>5. å€‹äººè³‡æ–™ä¿è­·ï¼šæœ¬åº—å°‡å¦¥å–„ä¿ç®¡æ‚¨çš„å€‹äººè³‡æ–™ã€‚</p><p>6. è‚–åƒæ¬Šä½¿ç”¨ï¼šåŒæ„æœ¬åº—æ‹æ”å¯µç‰©ç…§ç‰‡ç”¨æ–¼ç¤¾ç¾¤åˆ†äº«ã€‚</p><p>7. é ç´„å–æ¶ˆï¼šå¦‚éœ€å–æ¶ˆè«‹æå‰å‘ŠçŸ¥ã€‚</p><p>8. å…¶ä»–æœªç›¡äº‹å®œï¼Œä¾æœ¬åº—ç¾å ´å…¬å‘Šç‚ºä¸»ã€‚</p><div className="h-20"></div></div>
                        </div>
                    </TermsModal>

                    <TermsModal isOpen={activeModal === 'highRisk'} onClose={() => setActiveModal(null)} title="é«˜é¢¨éšªå¯µç‰©æœå‹™é¢¨éšªå‘ŠçŸ¥" onAgree={() => handleTermAgree('highRisk')}>
                        <div className="space-y-4">
                            <div className="bg-red-50 p-4 rounded-xl border border-red-100 flex items-start gap-3"><Icon name="alert-triangle" className="text-red-500 shrink-0 mt-1" /><p className="text-red-700 font-bold text-sm">æ‚¨çš„æ¯›å­©å·²æ»¿ 8 æ­²ï¼Œå±¬æ–¼é«˜é½¡éšæ®µã€‚ç”Ÿç†æ©Ÿèƒ½å¯èƒ½é€æ¼¸é€€åŒ–ã€‚</p></div>
                            <div className="space-y-3 text-justify"><p>1. é«˜é½¡å¯µç‰©åœ¨ç¾å®¹æˆ–ä½å®¿éç¨‹ä¸­ï¼Œå¯èƒ½æœƒå› ç·Šå¼µæˆ–å…¶ä»–ä¸å¯æŠ—åŠ›å› ç´ ï¼Œå¼•ç™¼æ½›åœ¨å¥åº·é¢¨éšªï¼ˆå¦‚å¿ƒè‚ºåŠŸèƒ½ç•°å¸¸ã€ä¼‘å…‹ç­‰ï¼‰ã€‚</p><p>2. æœ¬åº—å°‡ç›¡æœ€å¤§åŠªåŠ›ç…§é¡§ï¼Œä½†è‹¥å› å¯µç‰©è‡ªèº«å¹´é½¡æˆ–éš±ç–¾å°è‡´ä¹‹æ„å¤–ï¼Œæœ¬åº—ä¸è² æå®³è³ å„Ÿè²¬ä»»ã€‚</p><p>3. è‹¥ç™¼ç”Ÿç·Šæ€¥ç‹€æ³ï¼ŒåŒæ„æˆæ¬Šæœ¬åº—ç«‹å³é€é†«ï¼Œç›¸é—œè²»ç”¨ç”±é£¼ä¸»è² æ“”ã€‚</p></div><div className="h-20"></div>
                        </div>
                    </TermsModal>

                    {showFullSig && (
                        <div className="fullscreen-signature animate-fade-in"><div className="p-4 bg-lion-navy text-white flex justify-between items-center shrink-0 shadow-md"><span className="font-bold text-lg flex items-center gap-2"><Icon name="pen-tool" size={20}/> è«‹åœ¨æ­¤ç°½å</span><button onClick={()=>setShowFullSig(false)} className="p-2 hover:bg-white/10 rounded-full"><Icon name="x" size={24}/></button></div><div className="flex-1 bg-slate-100 relative p-4">
                                <div className="absolute inset-4 bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden">
                                    <canvas ref={fullSigCanvasRef} className="w-full h-full block cursor-crosshair"></canvas>
                                </div>
                                <div className="absolute bottom-6 right-6 text-slate-300 text-xs font-bold pointer-events-none">LION PET SIGNATURE</div>
                            </div><div className="p-6 bg-white border-t flex gap-4 shrink-0 safe-area-bottom"><button onClick={()=>{padInstance.current.clear()}} className="flex-1 py-4 bg-slate-100 font-bold text-slate-500 rounded-xl hover:bg-slate-200 transition-colors">æ¸…é™¤é‡å¯«</button><button onClick={saveSignature} className="flex-[2] py-4 bg-lion-navy font-bold text-white rounded-xl shadow-lg hover:bg-[#2A4B7C] transition-colors">ç¢ºèªç°½å</button></div></div>
                    )}

                    {showSuccess && (
                        <div className="fixed inset-0 z-[200] bg-lion-navy/40 backdrop-blur-md flex items-center justify-center p-4"><div className="bg-white rounded-[2rem] p-8 max-w-sm w-full text-center space-y-6 animate-slide-down shadow-2xl"><div className="w-24 h-24 bg-green-50 rounded-full flex items-center justify-center mx-auto text-green-500 mb-2"><Icon name="check" size={48} strokeWidth={3} /></div><div><h3 className="text-2xl font-serif font-bold text-lion-navy mb-3">é ç´„æˆåŠŸï¼</h3><p className="text-slate-500 text-sm leading-relaxed">æ‚¨çš„è³‡æ–™å·²æˆåŠŸé€å‡ºã€‚<br/>æˆ‘å€‘æœƒç›¡å¿«é€éé›»è©±æˆ– LINE èˆ‡æ‚¨ç¢ºèªã€‚</p></div><button onClick={() => window.location.reload()} className="w-full py-4 bg-lion-navy text-white rounded-xl font-bold shadow-lg hover:bg-[#2A4B7C] transition-colors">è¿”å›é¦–é </button></div></div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
